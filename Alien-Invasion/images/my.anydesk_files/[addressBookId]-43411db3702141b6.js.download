(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4187,8987],{60226:function(a,b,c){(window.__NEXT_P=window.__NEXT_P||[]).push(["/address-books/[addressBookId]",function(){return c(44553)}])},16607:function(a,b,c){"use strict";var d=c(41249),e=c(70184),f=c.n(e),g=c(67908),h=c(22056),i=c(75479),j=function(){var a,b,c=(0,i.E)(),e=(0,g.useQueryClient)(),j=(a=(0,d.Z)(f().mark(function a(b){var d;return f().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return d=b.addressBookId,a.next=3,c.delete("/address-books/".concat(d));case 3:case"end":return a.stop()}},a)})),function(b){return a.apply(this,arguments)});return(0,g.useMutation)(j,{onSuccess:(b=(0,d.Z)(f().mark(function a(b,c){var d,g;return f().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(d=c.addressBookId,!(g=c.onSuccess)){a.next=4;break}return a.next=4,g();case 4:return a.next=6,e.removeQueries({queryKey:h.X.addressBook.detail(d)});case 6:return a.next=8,e.invalidateQueries(h.X.addressBook.all());case 8:case"end":return a.stop()}},a)})),function(a,c){return b.apply(this,arguments)})})};b.Z=j},10353:function(a,b,c){"use strict";c.d(b,{Z:function(){return j}});var d=c(41249),e=c(70184),f=c.n(e),g=c(67908),h=c(22056),i=c(75479);function j(a,b){var c,e=(0,i.E)(),j=(c=(0,d.Z)(f().mark(function b(){var c;return f().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,e.get("/address-books/".concat(a));case 2:return c=b.sent.data,b.abrupt("return",c);case 4:case"end":return b.stop()}},b)})),function(){return c.apply(this,arguments)});return(0,g.useQuery)(h.X.addressBook.detail(a),j,b)}},18987:function(a,b,c){"use strict";c.d(b,{Z:function(){return j}});var d=c(41249),e=c(70184),f=c.n(e),g=c(67908),h=c(22056),i=c(75479);function j(a,b){var c,e=(0,i.E)(),j=(c=(0,d.Z)(f().mark(function b(){var c,d;return f().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return c=void 0!==a?"/admin/licenses/".concat(a):"license",b.next=3,e.get(c);case 3:return d=b.sent.data,b.abrupt("return",d);case 5:case"end":return b.stop()}},b)})),function(){return c.apply(this,arguments)});return(0,g.useQuery)(void 0!==a?h.X.license.detail(a):h.X.license.own(),j,b)}},13130:function(a,b,c){"use strict";c.d(b,{C:function(){return m}});var d=c(28409),e=c(15865),f=c(70079),g=c(89411),h=c(2794),i=c(46951),j=c(49602),k=c(74439),l=c(17280),m=function(a){var b=a.type,c=a.label,m=a.placeholder,n=a.value,o=a.required,p=a.disabled,q=a.multiline,r=a.fullWidth,s=a.outlined,t=a.minRows,u=a.maxRows,v=a.autoComplete,w=a.passwordToggleTime,x=a.disableMaxLength,y=a.noMargins,z=a.onBlur,A=a.errorText,B=a.tooltipProps,C=a.endAdornment,D=(0,f.useState)(n),E=D[0],F=D[1],G=(0,f.useState)(b),H=G[0],I=G[1],J=(0,f.useState)(!1),K=J[0],L=J[1],M=(0,f.useState)(!1),N=M[0],O=M[1],P=(0,f.useState)(-1),Q=P[0],R=P[1];return(0,f.useEffect)(function(){var a=-1;return"password"===b&&"text"===H&&w&&(a=setTimeout(function(){"password"===H?clearTimeout(a):I("password")},w)),function(){clearTimeout(a)}}),(0,e.BX)(h.Z,{display:"flex",alignItems:"center",justifyContent:"space-between",my:y?void 0:1.5,children:[c&&(0,e.BX)(h.Z,{display:"flex",alignItems:"center",children:[(0,e.tZ)(i.Z,{flexBasis:"100%",color:"textSecondary",variant:"body2",className:o?"required":"",children:c}),B&&(0,e.tZ)(l.kw,(0,d.Z)({},B))]}),(0,e.BX)(h.Z,{display:"flex",flexBasis:c?"65%":"100%",children:[(0,e.tZ)(j.Z,{autoComplete:v,disabled:p,multiline:q,fullWidth:r,type:H,style:{flexBasis:"100%"},color:"secondary",variant:s?"outlined":"standard",minRows:t,maxRows:u,placeholder:m,value:N?E:n,onFocus:function(){L(!0)},InputProps:{endAdornment:C,inputProps:x?{maxLength:void 0}:{}},onKeyUp:function(a){"Enter"!==a.key||q?R(setTimeout(function(){z&&z(a,!1,!q)},700)):z&&z(a,!0)},onKeyDown:function(a){clearTimeout(Q),"Enter"!==a.key||q||a.preventDefault()},onChange:function(a){O(!0),F(a.target.value)},onBlur:function(a){z&&z(a,!1,!q),O(!1),L(!1),"password"===b&&I("password")},onAnimationStart:function(a){"mui-auto-fill"===a.animationName&&z&&z(a)},error:Boolean(A),helperText:A}),"password"===b&&K&&E&&(0,e.tZ)(k.Z,{tabIndex:-1,"aria-label":"toggle password visibility",style:{height:"32px",marginLeft:"-40px"},onClick:function(){I("password"===H?"text":"password")},onMouseDown:function(a){return a.preventDefault()},edge:"end",children:"password"===H?(0,e.tZ)(g.Icons.VisibilityOff,{size:"lg"}):(0,e.tZ)(g.Icons.Visibility,{size:"lg"})})]})]})}},56901:function(a,b,c){"use strict";var d=c(15865),e=c(31953),f=function(a){var b=a.title,c=a.items,f=c.filter(function(a){return!0!==a.isHidden});return f.length>0?(0,d.tZ)(e.ZP,{title:b,elements:f}):(0,d.tZ)(d.HY,{})};b.Z=f},25120:function(a,b,c){"use strict";c.d(b,{v:function(){return p}});var d=c(28409),e=c(15865),f=c(89411),g=c(23727),h=c(2794),i=c(526),j=c(27986),k=c(33270),l=c(73713),m=c(75677),n={next:f.Icons.ArrowRightAlt,previous:f.Icons.ArrowLeftAlt},o=[m.Yu,m.WX,m.UZ,m.OE],p=function(){var a=(0,l.Sh)();if(!(0,l.KE)(a))throw TypeError("TablePagination only allowed in dynamic table");var b=a.page,c=a.paginationSupported,f=a.setPage,m=a.pageCount,p=a.pageSize,q=a.setPageSize,r=a.table;return r.rows.length?(0,e.BX)(h.Z,{display:"flex",flexWrap:"wrap",justifyContent:"right",children:[(0,e.tZ)(i.Z,{sx:{mx:2},children:(0,e.tZ)(j.Z,{defaultValue:p,sx:{px:1},onChange:function(a){return q(Number(a.target.value))},children:o.map(function(a){return(0,e.tZ)("option",{value:a,children:a},a)})})}),(0,e.tZ)(g.Z,{disabled:!c,siblingCount:1,boundaryCount:1,page:b,onChange:function(a,b){return f&&f(b)},count:m,renderItem:function(a){return(0,e.tZ)(e.HY,{children:(0,e.tZ)(k.Z,(0,d.Z)({components:n},a))})}})]}):null};b.Z=p},17443:function(a,b,c){"use strict";var d=c(28409),e=c(15865),f=c(2794),g=c(46951),h=c(57744),i=function(a){var b=a.disableTypography,c=a.children,i=a.variant,j=void 0===i?"body2":i,k=a.fontWeight,l=void 0===k?400:k,m=a.color,n=void 0===m?"unset":m,o=a.width,p=a.minWidth,q=a.maxWidth,r=a.link,s=a.sx,t=(0,d.Z)({},o&&{width:o},p&&{minWidth:p},q&&{maxWidth:q},s);return(0,e.tZ)(f.Z,{sx:t,children:r?(0,e.tZ)(h.W,{href:r,variant:j,fontWeight:l,color:n,children:c}):void 0!==b&&b?c:(0,e.tZ)(g.Z,{variant:j,fontWeight:l,color:n,children:c})})};b.Z=i},65030:function(a,b,c){"use strict";var d,e=c(41249),f=c(70184),g=c.n(f),h=c(15865),i=c(10969),j=c(13357),k=(d=(0,e.Z)(g().mark(function a(b,c){return g().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,i.ZP.promise(b,{loading:(0,h.tZ)(j.Z,{layout:"circular"}),success:"".concat(c," was successfully deleted"),error:function(a){return a.message}}).catch(function(a){return console.error(a)});case 2:case"end":return a.stop()}},a)})),function(a,b){return d.apply(this,arguments)});b.Z=k},59618:function(a,b,c){"use strict";c.d(b,{C1:function(){return o},Gu:function(){return u},ID:function(){return t},QH:function(){return r},Sz:function(){return s},Yi:function(){return q},cI:function(){return n},qu:function(){return p}});var d=c(41249),e=c(39175),f=c(28409),g=c(72569),h=c(29240),i=c(27219),j=c(46001),k=c(70184),l=c.n(k),m=c(70079),n=function(a){var b,c=a.validations,k=a.initialValues,n=a.onSubmit,o=a.onError,p=a.trimSpaces,q=void 0===p||p,r=(0,m.useState)(!1),s=r[0],t=r[1],u=(0,m.useState)(k||{}),v=u[0],w=u[1],x=(0,m.useState)({}),y=x[0],z=x[1],A=(0,m.useState)(!1),B=A[0],C=A[1],D=function(a,b,c,d){if("function"==typeof c){var i=c(b,v),k=i.isValid,l=i.message,m=i.reason,n=l;if(d&&"string"!=typeof l&&l&&(n=l.map(function(b,c){var e={},f=y[a],g=f&&f.message?f.message[c]:void 0;return g&&Object.keys(g).forEach(function(a){e[a]=g[a]}),e[d]=b[d],e})),k){y[a];var o=(0,h.Z)(y,[a].map(j.Z));z(o)}else z((0,g.Z)((0,f.Z)({},y),(0,e.Z)({},a,{message:n,reason:m})))}},E=(0,m.useCallback)(function(a,b){return function(d){var h=arguments.length>1&& void 0!==arguments[1]&&arguments[1],i=!(arguments.length>2)|| void 0===arguments[2]||arguments[2],j=d,k=j.data?j.data.value:"checkbox"===j.target.type?j.target.checked:b?b(j.target.value):j.target.value,l=q&&i&&k.trim?k.trim():k;w(function(b){return(0,g.Z)((0,f.Z)({},b),(0,e.Z)({},a,l))}),h&&C(h);var m=c?c[a]:void 0;m&&D(a,l,m)}},[v]),F=(0,m.useCallback)((b=(0,d.Z)(l().mark(function a(b){var d,e,h,j;return l().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(t(!0),null==b||b.preventDefault(),d=0,e=function(a,b,c,h){var j=b[c];if("function"==typeof j){var k=j(h,v),l=k.isValid,m=k.message,n=k.reason,o=k.map,p=k.customErrorCount;return!l&&(a[c]||(d+=p||1),a[c]={message:m,reason:n},o&&Object.entries(o).forEach(function(b){var c=(0,i.Z)(b,2),d=c[0],e=c[1],h=a[d],j=h.message,k=h.reason;a[d]=(0,g.Z)((0,f.Z)({},e),{message:j,reason:k})})),d}return Object.keys(j).forEach(function(b){a[b]={},e(a[b],j,b,h)}),d},!c||(h=0,j={},Object.keys(c).forEach(function(a){var b=v[a];h=e(j,c,a,b)}),!(Object.keys(j).length>0))){a.next=13;break}return t(!1),z(j),o&&o(j,h),a.abrupt("return");case 13:if(z({}),!n){a.next=18;break}return a.next=17,n();case 17:t(!1);case 18:case"end":return a.stop()}},a)})),function(a){return b.apply(this,arguments)}),[v]);(0,m.useEffect)(function(){B&&n&&(F(),C(!1))},[B]);var G=(0,m.useCallback)(function(a,b){b&&Object.entries(a).forEach(function(a){var d=(0,i.Z)(a,2),e=d[0],f=d[1],g=c?c[e]:void 0;g&&D(e,f,g,b)}),w(function(b){return(0,f.Z)({},b,a)})},[]);return{data:v,isSubmitting:s,handleChange:E,handleSubmit:F,setDataProps:G,errors:y}},o=function(a,b){return{isValid:!!a,message:b}},p=function(a,b,c){return{isValid:a===b,message:c}},q=function(a,b,c){return{isValid:b.length<=a,message:c}},r=function(a,b,c){return{isValid:b.length>=a,message:c}},s=function(a,b,c){return{isValid:a.test(b),message:c}},t=function(a){return{isValid:a,message:void 0,reason:"ignore"}},u=function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];for(var d=0;d<b.length;d++){var e=b[d],f=e.isValid,g=e.reason;if("ignore"===g&&f)break;if("ignore"!==g&&!f)return b[d]}return{isValid:!0}}},44553:function(a,b,c){"use strict";c.r(b),c.d(b,{default:function(){return av}});var d=c(41249),e=c(70184),f=c.n(e),g=c(15865),h=c(282),i=c.n(h),j=c(92182),k=c(10969),l=c(89411),m=c(66082),n=c(16607),o=c(10353),p=c(28409),q=c(67908),r=c(75677),s=c(22056),t=c(75479),u={limit:r.UZ},v=c(17280),w=c(75093),x=c(36516),y=c(13357),z=c(56901),A=c(65030),B=c(72569),C=c(29240),D=c(70079),E=c(69330),F=c(2794),G=c(94276),H=c(20154),I=c(83206),J=c(11753),K=c(13130),L=c(59618),M=c(82984),N=c(72163),O=c(29934),P=function(a){var b,c,e,h,i,j,l=a.data,n=(0,C.Z)(a,["data"]),o=(0,D.useState)(!1),r=o[0],u=o[1],w=l.name,x=l.addressBookId,y=l.personal,z=(0,M.L)().api,A=y?z.addressBooks.filter("own").update:z.addressBooks.update,P=(c=(0,t.E)(),e=(0,q.useQueryClient)(),i=(h=(0,d.Z)(f().mark(function a(b){var d,e,g,h;return f().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(d=b.addressBookId,e=b.input,g=b.requestConfig,!(h=b.personal)){a.next=6;break}return a.next=4,c.patch("/address-books/personal",e,g);case 4:a.next=8;break;case 6:return a.next=8,c.patch("/address-books/".concat(d),e,g);case 8:case"end":return a.stop()}},a)})),function(a){return h.apply(this,arguments)}),(0,q.useMutation)(i,{onSuccess:(j=(0,d.Z)(f().mark(function a(b,c){var d;return f().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return d=c.addressBookId,a.next=3,Promise.all([e.invalidateQueries({queryKey:s.X.addressBook.all(),refetchInactive:!0}),e.invalidateQueries(s.X.addressBook.detail(d)),]);case 3:case"end":return a.stop()}},a)})),function(a,b){return j.apply(this,arguments)})})),Q=(0,L.cI)({initialValues:l,validations:{name:function(a){return(0,L.Gu)((0,L.C1)(a,O.ZP.FIELD_ERROR.NAME_AB_REQ))}},onSubmit:(0,d.Z)(f().mark(function a(){return f().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,P.mutateAsync({addressBookId:x,input:S,personal:S.personal}).then(function(){u(!1),k.ZP.success(O.ZP.SUCCESS.AB_UPDATED,{id:"addressBookUpdateSuccess"})}).catch(function(a){k.ZP.error(a.response.data.message)});case 2:case"end":return a.stop()}},a)}))}),R=Q.isSubmitting,S=Q.data,T=Q.errors,U=Q.handleChange,V=Q.handleSubmit,W=S.name,X=(0,g.tZ)(G.Z,{size:"small",variant:"contained",onClick:function(){return u(!r)},children:r?"Close":"Edit"});return(0,g.BX)(H.Z,(0,B.Z)((0,p.Z)({},n),{children:[(0,g.tZ)(J.Z,{title:"About",action:A&&X}),(0,g.BX)(I.Z,{children:[!r&&(0,g.tZ)(v.rA,{children:(0,g.tZ)(v.VT,{label:"Name",value:(0,N.$G)(w)})}),r&&(0,g.tZ)("form",{onSubmit:V,children:(0,g.BX)(F.Z,{children:[(0,g.tZ)(m.ZP,{container:!0,spacing:3,children:(0,g.tZ)(m.ZP,{item:!0,xs:12,children:(0,g.tZ)(K.C,{label:"Address Book Name",value:W,onBlur:U("name"),errorText:null===(b=T.name)|| void 0===b?void 0:b.message})})}),(0,g.tZ)(F.Z,{mt:2,mb:1,children:(0,g.tZ)(E.Z,{variant:"contained",fullWidth:!0,type:"submit",loading:R,children:"Save Address Book"})})]})})]})]}))},Q={limit:r.UZ},R=c(66216),S=c(25120),T=c(13176),U=c(1182),V=c(90820),W=c(12303),X=c(46951),Y=c(17443),Z=[{Header:"Name",accessor:"name"},{Header:"Address",accessor:"alias",Cell:function(a){var b=a.row.original,c=b.alias,d=b.hostname,e=b.clientId;return(0,g.BX)(Y.Z,{disableTypography:!0,children:[(c||d)&&(0,g.tZ)(X.Z,{color:"inherit",variant:"subtitle2",children:c||d}),(0,g.tZ)(X.Z,{variant:"body2",children:e})]})}},{Header:"Tags",accessor:"tags",Cell:function(a){var b=a.row.original.tags;return(0,g.tZ)(Y.Z,{disableTypography:!0,children:b.map(function(a){return(0,g.tZ)(W.Z,{sx:{mx:.25,mb:.25},label:a,color:"default",variant:"outlined",size:"small"},a)})})}},],$=c(69792),_=c(49602);function aa(){var a,b,c=(0,t.E)(),e=(0,q.useQueryClient)(),g=(a=(0,d.Z)(f().mark(function a(b){var d,e,g,h;return f().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return d=b.addressBookId,e=b.itemIds,g=b.tags,h=b.requestConfig,a.next=3,Promise.all(e.map(function(a){return c.put("/address-books/".concat(d,"/items/").concat(a,"/tags"),g,h)}));case 3:case"end":return a.stop()}},a)})),function(b){return a.apply(this,arguments)});return(0,q.useMutation)(g,{onSuccess:(b=(0,d.Z)(f().mark(function a(b,c){var d;return f().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return d=c.addressBookId,a.next=3,e.invalidateQueries(s.X.addressBook.detail(d));case 3:case"end":return a.stop()}},a)})),function(a,c){return b.apply(this,arguments)})})}var ab=c(13877),ac=function(a){var b,c=a.addressBookId,e=a.itemIds,h=a.isOpen,i=a.hide,j=(0,D.useState)(new Set),l=j[0],n=j[1],o=(0,D.useState)(""),p=o[0],q=o[1],r=aa(),s=(0,$.TA)({initialValues:{tag:""},onSubmit:(b=(0,d.Z)(f().mark(function a(b,d){var g,h;return f().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return g=d.resetForm,h=d.setFieldError,0===l.size&&h("tag","Please add at least one tag"),a.next=4,r.mutateAsync({addressBookId:c,itemIds:e,tags:Array.from(l)}).then(function(){k.Am.success("".concat(1===l.size?"Tag":"Tags"," ").concat(Array.from(l).map(function(a){return'"'.concat(a,'"')}).join(", ")," added"),{id:"tagAddSuccess"})}).catch(function(a){var b=a.message;k.Am.error(b),g()}).finally(function(){return i()});case 4:case"end":return a.stop()}},a)})),function(a,c){return b.apply(this,arguments)})}),t=function(a){l.delete(a),n(new Set(l))},u=function(a){("Enter"===a.key||","===a.key)&&(!p||/^\s*$/.test(p)?s.setFieldError("tag","Tag can't be blank or empty"):l.has(p.trim())?s.setFieldError("tag",'Tag "'.concat(p.trim(),'" already added!')):(l.add(p.trim()),n(new Set(l)),q(""),s.setFieldValue("tag","")),a.preventDefault())};return(0,g.tZ)(ab.Z,{id:"add-tags",title:"Add tags",open:h,onClose:i,actions:(0,g.tZ)(E.Z,{variant:"contained",fullWidth:!0,type:"submit",loading:s.isSubmitting,disabled:s.dirty||0===l.size,onClick:function(){return s.handleSubmit()},children:"Add tags"}),children:(0,g.tZ)("form",{onSubmit:s.handleSubmit,children:(0,g.tZ)(F.Z,{pt:3,children:(0,g.tZ)(m.ZP,{container:!0,spacing:3,children:(0,g.BX)(m.ZP,{item:!0,xs:12,children:[(0,g.tZ)(_.Z,{fullWidth:!0,id:"tag",name:"tag",label:"Tags",value:p,error:Boolean(s.errors.tag),helperText:s.errors.tag,onChange:function(a){q(a.target.value),s.handleChange(a),a.preventDefault()},onKeyPress:u}),(0,g.tZ)(X.Z,{component:"p",fontSize:12,my:1,children:"Press ENTER or add a COMMA after your Tag name to add it to the Entry"}),(0,g.tZ)(F.Z,{mt:2,children:Array.from(l).map(function(a){return(0,g.tZ)(W.Z,{sx:{mx:.25},label:a,onDelete:function(){return t(a)},variant:"outlined"},a)})})]})})})})})},ad=c(94913),ae=c(66967),af=c(85046);function ag(){var a,b,c=(0,t.E)(),e=(0,q.useQueryClient)(),g=(a=(0,d.Z)(f().mark(function a(b){var d,e,g;return f().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return d=b.itemId,e=b.addressBookId,g=b.tags,a.next=3,c({method:"delete",url:"/address-books/".concat(e,"/items/").concat(d,"/tags"),data:g});case 3:case"end":return a.stop()}},a)})),function(b){return a.apply(this,arguments)});return(0,q.useMutation)(g,{onSuccess:(b=(0,d.Z)(f().mark(function a(b,c){var d;return f().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return d=c.addressBookId,a.next=3,e.invalidateQueries(s.X.addressBook.detail(d));case 3:case"end":return a.stop()}},a)})),function(a,c){return b.apply(this,arguments)})})}var ah=c(52708),ai=c(78953);function aj(a){return a>=1e5&&a<=4294967295}function ak(a){var b;return"number"==typeof a?aj(a):(0,ah.kE)(a)?aj(parseInt(a,10)):(b=a,ai.uY.test(b))}var al=(0,D.forwardRef)(function(a,b){var c,e,h,i,j,l,n,o,r,u,v,w=a.item,x=a.tagsOptions,y=a.onSave,z=(0,D.useState)(w.tags),A=z[0],C=z[1],E=(0,D.useState)([]),G=E[0],H=E[1],I=(0,D.useState)([]),J=I[0],K=I[1],L=(0,D.useState)(""),M=L[0],N=L[1],P=(c=(0,t.E)(),e=(0,q.useQueryClient)(),h=aa(),i=ag(),l=(j=(0,d.Z)(f().mark(function a(b){var c,d,e,g,j,k;return f().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return c=b.itemId,d=b.addressBookId,g=(e=b.input).tagsToApply,j=e.tagsToRemove,k=[],(null==g?void 0:g.length)&&k.push(h.mutateAsync({addressBookId:d,itemIds:[c],tags:g})),(null==j?void 0:j.length)&&k.push(i.mutateAsync({addressBookId:d,itemId:c,tags:j})),a.next=7,Promise.all(k);case 7:case"end":return a.stop()}},a)})),function(a){return j.apply(this,arguments)}),o=(n=(0,d.Z)(f().mark(function a(b){var d,e,g,h,i,j,k;return f().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return d=b.addressBookId,e=b.itemId,g=b.input,h=b.requestConfig,i=g.name,j=g.address,k=g.comment,a.t0=Promise,a.next=5,c.patch("/address-books/".concat(d,"/items/").concat(e),{name:i,address:j,comment:k},h);case 5:return a.t1=a.sent,a.next=8,l({addressBookId:d,itemId:e,input:g});case 8:return a.t2=a.sent,a.t3=[a.t1,a.t2,],a.next=12,a.t0.all.call(a.t0,a.t3);case 12:case"end":return a.stop()}},a)})),function(a){return n.apply(this,arguments)}),(0,q.useMutation)(o,{onSuccess:(r=(0,d.Z)(f().mark(function a(b,c){var d;return f().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return d=c.addressBookId,a.next=3,Promise.all([e.invalidateQueries({queryKey:s.X.addressBook.all(),refetchInactive:!0}),e.invalidateQueries(s.X.addressBook.detail(d)),]);case 3:case"end":return a.stop()}},a)})),function(a,b){return r.apply(this,arguments)})})),Q=ag(),R=x.items,S=ae.Ry({name:ae.Z_().required(O.ZP.FIELD_ERROR.NAME_REQ),address:ae.Z_().required(O.ZP.FIELD_ERROR.ADDRESS_REQ)}),T=function(a){if("Enter"===a.key||","===a.key){var b=M.trim(),c=b&& -1===J.indexOf(b),d=A.includes(b);d&&(a.defaultMuiPrevented=!0),c&&!d&&(K((0,ad.Z)(J).concat([b])),N("")),a.preventDefault()}},U=(u=(0,d.Z)(f().mark(function a(b){var c;return f().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return C(c=A.filter(function(a){return a!==b})),a.next=4,Q.mutateAsync({addressBookId:w.addressBookId,itemId:w.itemId,tags:[b]});case 4:case"end":return a.stop()}},a)})),function(a){return u.apply(this,arguments)}),V=(0,$.TA)({initialValues:{name:w.name,comment:w.comment,tagsToApply:[],address:w.alias||w.hostname||w.clientId},validationSchema:S,onSubmit:(v=(0,d.Z)(f().mark(function a(b,c){var d,e,g;return f().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(d=c.resetForm,e=c.setFieldError,ak(g=b.address)){a.next=5;break}return e("address",O.ZP.FIELD_ERROR.ADDRESS),a.abrupt("return");case 5:return a.next=7,P.mutateAsync({addressBookId:w.addressBookId,itemId:w.itemId,input:(0,B.Z)((0,p.Z)({},b),{tagsToApply:J})}).then(function(){return d()}).then(function(){return y()}).catch(function(a){var b;k.ZP.error(null===(b=a.response.data)|| void 0===b?void 0:b.message)});case 7:case"end":return a.stop()}},a)})),function(a,b){return v.apply(this,arguments)})});return(0,D.useEffect)(function(){H(R.filter(function(a){return!A.includes(a.name)}))},[A,R,J]),(0,g.tZ)("form",{ref:b,onSubmit:V.handleSubmit,children:(0,g.tZ)(F.Z,{pt:2,mb:-1,children:(0,g.BX)(m.ZP,{container:!0,spacing:3,children:[(0,g.tZ)(m.ZP,{item:!0,xs:12,children:(0,g.tZ)(_.Z,{fullWidth:!0,id:"name",name:"name",label:"Name",value:V.values.name,onChange:V.handleChange,error:V.touched.name&&Boolean(V.errors.name),helperText:V.touched.name&&V.errors.name})}),(0,g.tZ)(m.ZP,{item:!0,xs:12,children:(0,g.tZ)(_.Z,{fullWidth:!0,id:"address",name:"address",label:"Address (client id or alias)",value:V.values.address,onChange:V.handleChange,error:V.touched.address&&Boolean(V.errors.address),helperText:V.touched.address&&V.errors.address})}),(0,g.tZ)(m.ZP,{item:!0,xs:12,children:(0,g.tZ)(_.Z,{fullWidth:!0,id:"comment",name:"comment",label:"Comment",multiline:!0,rows:3,value:V.values.comment||"",onChange:V.handleChange,error:V.touched.comment&&Boolean(V.errors.comment),helperText:V.touched.comment&&V.errors.comment})}),(0,g.BX)(m.ZP,{item:!0,xs:12,children:[(0,g.tZ)(af.Z,{id:"tags-edit-outlined",multiple:!0,freeSolo:!0,value:J,filterSelectedOptions:!0,onChange:function(a,b){K(b)},inputValue:M,onInputChange:function(a,b){N(b)},renderTags:function(a,b){return a.map(function(a,c){return(0,g.tZ)(W.Z,(0,p.Z)({variant:"outlined",label:a},b({index:c})))})},onKeyDown:T,options:G.map(function(a){return a.name}),renderInput:function(a){return(0,g.tZ)(_.Z,(0,B.Z)((0,p.Z)({},a),{label:"Add Tags"}))}}),(0,g.tZ)(X.Z,{component:"p",fontSize:12,my:1,children:"Press ENTER or add a COMMA after your Tag name to add it to the Entry"}),A.length>0&&(0,g.tZ)(F.Z,{mt:2,children:A.map(function(a){return(0,g.tZ)(W.Z,{sx:{mx:.25,mb:.5},label:a,onDelete:function(){return U(a)},variant:"outlined"},a)})})]})]})})})}),am=function(a){var b=a.item;return(0,g.BX)(v.rA,{children:[(0,g.tZ)(v.VT,{label:"Name",value:b.name}),(0,g.tZ)(v.VT,{label:"Address",value:b.alias||b.clientId}),(0,g.tZ)(v.VT,{label:"Client ID",value:b.clientId||"unknown"}),(0,g.tZ)(v.VT,{label:"Comment",value:b.comment}),(0,g.tZ)(v.VT,{label:"Tags",value:b.tags.length>0?b.tags.map(function(a){return(0,g.tZ)(W.Z,{sx:{mx:.25,mb:.5},label:a,variant:"outlined",size:"small"},a)}):"This address book item has no tags"})]})},an=function(a){var b=a.isOpen,c=a.isPersonal,d=a.hide,e=a.item,f=a.tagsData,h=(0,D.useState)(!1),i=h[0],j=h[1],k=(0,D.useState)(!1),l=k[0],m=k[1],n=(0,D.useRef)(null),o=(0,M.L)().api,p=function(){j(!0),n.current&&n.current.dispatchEvent(new Event("submit",{bubbles:!0,cancelable:!0}))},q=function(){m(!l),j(!1),d()},r=l?(0,g.tZ)(E.Z,{variant:"contained",fullWidth:!0,onClick:p,loading:i,children:"Save item"}):(0,g.tZ)(G.Z,{variant:"contained",onClick:function(){return m(!l)},children:"Edit"});return(0,g.tZ)(ab.Z,{id:"address-book-item",title:"Address Book Entry",open:b,onClose:d,actions:(c?o.addressBooks.filter("own").update:o.addressBooks.update)&&r,children:l?(0,g.tZ)(al,{ref:n,onSave:q,tagsOptions:f,item:e}):(0,g.tZ)(am,{item:e})})},ao=ae.Ry({name:ae.Z_().required(O.ZP.FIELD_ERROR.NAME_REQ),address:ae.Z_().required(O.ZP.FIELD_ERROR.ADDRESS_REQ)}),ap=function(a){var b,c,e,h,i,j=a.addressBookId,l=a.tagsData,n=a.isOpen,o=a.hide,r=(0,D.useState)([]),u=r[0],v=r[1],w=(0,D.useState)(""),x=w[0],y=w[1],z=(0,D.useState)([]),A=z[0],G=z[1],H=(b=(0,t.E)(),c=(0,q.useQueryClient)(),h=(e=(0,d.Z)(f().mark(function a(c){var d,e,g,h,i,j,k,l;return f().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return d=c.addressBookId,e=c.input,g=e.name,h=e.address,i=e.tags,j=e.comment,k=c.requestConfig,a.next=3,b.post("/address-books/".concat(d,"/items"),{name:g,address:h,tags:i,comment:j},k);case 3:return l=a.sent.data,a.abrupt("return",l);case 5:case"end":return a.stop()}},a)})),function(a){return e.apply(this,arguments)}),(0,q.useMutation)(h,{onSuccess:(i=(0,d.Z)(f().mark(function a(b){var d;return f().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return d=b.addressBookId,a.next=3,c.invalidateQueries(s.X.addressBook.all());case 3:return a.next=5,c.invalidateQueries(s.X.addressBook.detail(d));case 5:case"end":return a.stop()}},a)})),function(a){return i.apply(this,arguments)})})),I=l.items;(0,D.useEffect)(function(){v(I)},[I]);var J,K=function(){G([]),o()},L=function(a){if("Enter"===a.key||","===a.key){var b=x.trim();b&& -1===A.indexOf(b)&&(G((0,ad.Z)(A).concat([b])),y("")),a.preventDefault()}},M=(0,$.TA)({initialValues:{name:"",comment:"",tags:[],address:""},validationSchema:ao,onSubmit:(J=(0,d.Z)(f().mark(function a(b,c){var d,e,g,h,i;return f().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(d=b.address,e=(0,C.Z)(b,["address"]),g=c.resetForm,h=c.setFieldError,ak(i=d.replace(/\s+/g,""))){a.next=5;break}return h("address",O.ZP.FIELD_ERROR.ADDRESS),a.abrupt("return");case 5:return a.prev=5,a.next=8,H.mutateAsync({addressBookId:j,input:(0,B.Z)((0,p.Z)({},e),{address:i,tags:A})});case 8:g(),k.ZP.success(O.ZP.SUCCESS.AB_CREATED),K(),a.next=16;break;case 13:a.prev=13,a.t0=a.catch(5),k.ZP.error(a.t0.response.data.message);case 16:case"end":return a.stop()}},a,null,[[5,13]])})),function(a,b){return J.apply(this,arguments)})});return(0,g.tZ)(ab.Z,{id:"create-ad-entry",title:"Create Entry",open:n,onClose:o,actions:(0,g.tZ)(E.Z,{variant:"contained",type:"submit",loading:M.isSubmitting,onClick:function(){return M.handleSubmit()},children:"Create entry"}),children:(0,g.tZ)("form",{onSubmit:M.handleSubmit,children:(0,g.tZ)(F.Z,{pt:2,mb:-1,children:(0,g.BX)(m.ZP,{container:!0,spacing:3,children:[(0,g.tZ)(m.ZP,{item:!0,xs:12,children:(0,g.tZ)(_.Z,{fullWidth:!0,id:"name",name:"name",label:"Nickname",value:M.values.name,onChange:M.handleChange,error:M.touched.name&&Boolean(M.errors.name),helperText:M.touched.name&&M.errors.name})}),(0,g.tZ)(m.ZP,{item:!0,xs:12,children:(0,g.tZ)(_.Z,{fullWidth:!0,id:"address",name:"address",label:"Address (client id or alias)",value:M.values.address.replace(/\s+/g,""),onChange:M.handleChange,error:M.touched.address&&Boolean(M.errors.address),helperText:M.touched.address&&M.errors.address})}),(0,g.tZ)(m.ZP,{item:!0,xs:12,children:(0,g.tZ)(_.Z,{fullWidth:!0,id:"comment",name:"comment",label:"Comment",multiline:!0,rows:3,value:M.values.comment,onChange:M.handleChange,error:M.touched.comment&&Boolean(M.errors.comment),helperText:M.touched.comment&&M.errors.comment})}),(0,g.BX)(m.ZP,{item:!0,xs:12,children:[(0,g.tZ)(af.Z,{id:"tags-outlined",multiple:!0,freeSolo:!0,value:A,filterSelectedOptions:!0,onChange:function(a,b){G(b)},inputValue:x,onInputChange:function(a,b){y(b)},renderTags:function(a,b){return a.map(function(a,c){return(0,g.tZ)(W.Z,(0,p.Z)({variant:"outlined",label:a},b({index:c})))})},onKeyDown:L,options:u.map(function(a){return a.name}),renderInput:function(a){return(0,g.tZ)(_.Z,(0,B.Z)((0,p.Z)({},a),{label:"Tags"}))}}),(0,g.tZ)(X.Z,{component:"p",fontSize:12,my:1,children:"Press ENTER or add a COMMA after your Tag name to add it to the Entry"})]})]})})})})},aq=c(5987),ar=function(a){var b,c,e,h,i,j,m=a.isPersonal,n=a.addressBookId,o=a.tagsData,r=(0,D.useState)([]),u=r[0],v=r[1],x=(0,D.useState)([]),y=x[0],z=x[1],A=(0,M.L)().api,B=m?A.addressBooks.filter("own").update:A.addressBooks.update,C=m?A.addressBooks.filter("own").delete:A.addressBooks.delete,E=(b=(0,t.E)(),c=(0,q.useQueryClient)(),h=(e=(0,d.Z)(f().mark(function a(c){var d,e;return f().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return d=c.itemId,e=c.addressBookId,a.next=3,b.delete("/address-books/".concat(e,"/items/").concat(d));case 3:case"end":return a.stop()}},a)})),function(a){return e.apply(this,arguments)}),(0,q.useMutation)(h,{onSuccess:(i=(0,d.Z)(f().mark(function a(b,d){var e;return f().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return e=d.addressBookId,a.next=3,c.invalidateQueries(s.X.addressBook.detail(e));case 3:case"end":return a.stop()}},a)})),function(a,b){return i.apply(this,arguments)})})),F=function(a){return function(a){var b,c=arguments.length>1&& void 0!==arguments[1]?arguments[1]:{},e=arguments.length>2?arguments[2]:void 0,g=(0,t.E)(),h=(0,p.Z)({},Q,c),i=(b=(0,d.Z)(f().mark(function b(){var c;return f().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,g.get("/address-books/".concat(a,"/items"),{params:h});case 2:return c=b.sent.data,b.abrupt("return",c);case 4:case"end":return b.stop()}},b)})),function(){return b.apply(this,arguments)});return(0,q.useQuery)(s.X.addressBook.items(a,h),i,e)}(Number(n),(0,p.Z)({},a),{onError:function(a){k.Am.error("".concat(a)),console.error('Address book detail page "useAddressBookItems" '.concat(a))}})},K=(0,aq.Z)(),L=K.open,N=K.show,O=K.hide,P=(0,aq.Z)(),W=P.open,X=P.show,Y=P.hide,$=(0,aq.Z)(),_=$.open,aa=$.show,ab=$.hide,ad=(0,aq.Z)(),ae=ad.open,af=ad.show,ag=ad.hide,ah=function(a){v([a.original]),af()},ai=function(a){v(a.map(function(a){return a.original})),N()},aj=(j=(0,d.Z)(f().mark(function a(){var b;return f().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return b="Selected ".concat(u.length>1?"items have":"item has"," been deleted"),a.next=3,Promise.all(u.map(function(a){return E.mutateAsync({addressBookId:a.addressBookId,itemId:a.itemId})})).then(function(){return k.Am.success(b)}).catch(function(){return k.Am.error("Error while deleting address book entry")});case 3:case"end":return a.stop()}},a)})),function(){return j.apply(this,arguments)}),ak=function(a){z(a.map(function(a){return a.original.itemId})),aa()},al=A.addressBooks.filter(m?"own":void 0).create&&(0,g.tZ)(G.Z,{startIcon:(0,g.tZ)(l.Icons.Add,{}),onClick:X,color:"primary",size:"small",variant:"contained",children:"Create Entry"});return(0,g.BX)(H.Z,{children:[(0,g.tZ)(J.Z,{title:"Entries",action:al}),(0,g.tZ)(I.Z,{children:(0,g.BX)(T.a,{query:F,columns:Z,onRowClick:ah,children:[(B||C)&&(0,g.BX)(U.f,{children:[B&&(0,g.tZ)(V.h,{title:"Add Tags",action:ak,side:"left"}),C&&(0,g.tZ)(V.h,{title:"Delete",action:ai,side:"right"})]}),(0,g.tZ)(R.i,{}),(0,g.tZ)(S.Z,{})]})}),W&&(0,g.tZ)(ap,{addressBookId:Number(n),tagsData:o,isOpen:W,hide:Y}),u&&ae&&(0,g.tZ)(an,{isPersonal:!0,item:u[0],tagsData:o,isOpen:ae,hide:ag}),_&&n&&(0,g.tZ)(ac,{addressBookId:n,itemIds:y,isOpen:_,hide:ab}),L&&(0,g.tZ)(w.Z,{hide:O,isOpen:L,onAccept:aj})]})},as=i()(function(){return c.e(756).then(c.bind(c,20756))},{loadableGenerated:{webpack:function(){return[20756]}}}),at=i()(function(){return c.e(8471).then(c.bind(c,65297))},{loadableGenerated:{webpack:function(){return[65297]}}}),au=function(){var a=(0,j.useRouter)(),b=(0,M.L)().api,c=(0,aq.Z)(),e=c.open,h=c.show,i=c.hide,r=a.query.addressBookId,x=(0,n.Z)(),B=(0,o.Z)(Number(r),{onError:function(a){k.ZP.error("".concat(a)),console.error('Address book detail page "useAddressBook" '.concat(a))}}),C=B.data,D=B.isLoading,E=B.error,F=function(a){var b,c=arguments.length>1&& void 0!==arguments[1]?arguments[1]:{},e=arguments.length>2?arguments[2]:void 0,g=(0,t.E)(),h=(0,p.Z)({},u,c),i=(b=(0,d.Z)(f().mark(function b(){var c;return f().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,g.get("/address-books/".concat(a,"/tags"),{params:h});case 2:return c=b.sent.data,b.abrupt("return",c);case 4:case"end":return b.stop()}},b)})),function(){return b.apply(this,arguments)});return(0,q.useQuery)(s.X.addressBook.tags(a),i,e)}(Number(r),{},{onError:function(a){k.ZP.error("".concat(a)),console.error('Address book detail page "useAddressbookTags" '.concat(a))}}),G=F.data,H=F.isLoading,I=F.error,J=(null==C?void 0:C.personal)?b.addressBooks.filter("own").delete:b.addressBooks.delete;if(D||H)return(0,g.tZ)(y.Z,{layout:"detail"});if(E||I)throw E||I;if(!C||!G)throw Error("Address book detail page error: no data");var K,L=(K=(0,d.Z)(f().mark(function b(){var c;return f().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return c=x.mutateAsync({addressBookId:Number(r),onSuccess:(0,d.Z)(f().mark(function b(){return f().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,a.push("/address-books");case 2:case"end":return b.stop()}},b)}))}),b.next=3,(0,A.Z)(c,"Address Book ".concat(C.name));case 3:case"end":return b.stop()}},b)})),function(){return K.apply(this,arguments)});return(0,g.BX)(as,{children:[(0,g.tZ)(v.mr,{title:C.name,children:(0,g.tZ)(z.Z,{items:[{title:"Delete",onClick:h,icon:(0,g.tZ)(l.Icons.Delete,{}),color:"primary",isHidden:C.personal||!J},]})}),(0,g.BX)(m.ZP,{container:!0,spacing:3,mb:3,children:[(0,g.tZ)(m.ZP,{item:!0,xs:12,md:6,children:(0,g.tZ)(P,{data:C})}),(0,g.tZ)(m.ZP,{item:!0,xs:12,md:6,children:(0,g.tZ)(at,{addressBookId:Number(r),data:G,isPersonal:null==C?void 0:C.personal})})]}),(0,g.tZ)(ar,{addressBookId:Number(r),isPersonal:C.personal,tagsData:G}),e&&(0,g.tZ)(w.Z,{hide:i,isOpen:e,onAccept:L})]})};au.Layout=x.default;var av=au},78953:function(a,b,c){"use strict";c.d(b,{BR:function(){return o},BV:function(){return p},SI:function(){return l},Uo:function(){return i},Y0:function(){return n},"_":function(){return g},"_G":function(){return k},mh:function(){return j},sr:function(){return m},tt:function(){return f},uY:function(){return h},yk:function(){return e}});var d=c(94913),e=RegExp(/^[a-zA-Z0-9!#$%&'*+/=?^_`{|}~.-]+@[a-zA-Z0-9-]+(\.[a-zA-Z0-9-]+)*$/);function f(a){return e.test(a)}function g(a){return(0,d.Z)(a.trim().matchAll(/(?:"([^"]+)")? ?<?(.*?@[^>,]+)>?,? ?/g))}RegExp(/((https):\/\/)(www.)?[-a-z0-9]+(\.[a-z]{2,}){1,3}(#?\/?[a-zA-Z0-9#]+)*\/?(\?[a-zA-Z0-9-_]+=[a-zA-Z0-9-%]+&?)?$/);var h=RegExp(/^([A-Za-z0-9_\-.]{1,25})@([A-Za-z0-9_\-.]{1,50})$/),i=RegExp(/^[\d|+.()\s/-]+$/),j=RegExp(/^[A-Za-z0-9._ -]+$/),k=RegExp(/^[a-z0-9-]+$/),l=j,m=RegExp(/^[A-Za-z0-9._-]+$/),n=function(a,b){return RegExp("^(?=.{".concat(a,",").concat(b,"}$)[a-z]+[a-z0-9]+$"),"g")},o=RegExp(/^\S+$/),p=RegExp(/^(?=.*?[a-z])(?=.*?[A-Z])(?=.*?[0-9]).*$/)},46001:function(a,b,c){"use strict";c.d(b,{Z:function(){return e}});var d=c(37724);function e(a){var b=function(a,b){if("object"!==(0,d.Z)(a)||null===a)return a;var c=a[Symbol.toPrimitive];if(void 0!==c){var e=c.call(a,b||"default");if("object"!==(0,d.Z)(e))return e;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===b?String:Number)(a)}(a,"string");return"symbol"===(0,d.Z)(b)?b:String(b)}}},function(a){a.O(0,[3457,119,1418,7848,7390,5734,3738,7457,8535,9792,6967,5507,264,7280,6516,9774,2888,179],function(){var b;return a(a.s=60226)}),_N_E=a.O()}])