(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1049],{81090:function(a,b,c){(window.__NEXT_P=window.__NEXT_P||[]).push(["/license",function(){return c(10559)}])},10559:function(a,b,c){"use strict";c.r(b),c.d(b,{default:function(){return aw}});var d=c(41249),e=c(70184),f=c.n(e),g=c(15865),h=c(90002),i=c.n(h),j=c(71366),k=c(282),l=c.n(k),m=c(66082),n=c(86852),o=c(67908),p=c(22056),q=c(75479),r=c(18987),s=c(17280),t=c(36516),u=c(13357),v=c(1622),w=c(92182),x=c(70079),y=c(10969),z=c(89411),A=c(69330),B=c(75093),C=function(a){var b=a.isOpen,c=a.hide,d=a.content;return(0,g.tZ)(B.Z,{isOpen:b,hide:c,actionTitle:"Oops, something went wrong...",actionContent:d,actionBtnText:"Ok",hideSecondaryBtn:!0})},D=c(39711),E=c(5987),F=c(10287),G=c(82984),H=function(a){var b,c,e,h,i=a.license,j=a.customerData,k=a.getReactivateConditions,l=a.onReactivateLicense,m=(0,w.useRouter)(),n=(0,G.L)(),r=n.api,t=n.isTeam,u=n.isTeamOwner,v=n.permitTeamRoleAnyOf,B=(0,E.Z)(C),H=B.dialog,I=B.show,J=(0,E.Z)(),K=J.open,L=J.show,M=J.hide;(0,x.useEffect)(function(){var a,b,c=new URLSearchParams(m.asPath.split("#")[1]),d=null!==(a=c.get("shop_success"))&& void 0!==a?a:"",e=null!==(b=c.get("shop_error"))&& void 0!==b?b:"";"change-sub"===e&&I({content:"Upgrading your license was unsuccessful. Please contact us to finalize the upgrade process."}),"pay-invoice"===e&&I({content:"Paying the invoice was unsuccessful. Please contact us if the error persists."}),"add-instrument"===d&&I({content:"Payment card successfully added"}),"add-instrument"===e&&I({content:"Adding the payment method failed. Please contact us if the error persists."}),"change-sub"===d&&y.ZP.success("Your license has been upgraded successfully"),"pay-invoice"===d&&y.ZP.success("Invoice paid successfully")},[]);var N,O=(b=(0,q.E)(),c=(0,o.useQueryClient)(),h=(e=(0,d.Z)(f().mark(function a(){var c;return f().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,b.post("/license/reset-key");case 2:return c=a.sent.data,a.abrupt("return",c);case 4:case"end":return a.stop()}},a)})),function(){return e.apply(this,arguments)}),(0,o.useMutation)(h,{onSuccess:(0,d.Z)(f().mark(function a(){return f().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,c.invalidateQueries(p.X.license.own());case 2:case"end":return a.stop()}},a)}))})),P=(0,F.t)(i),Q=P.isLoading,R=P.handleUpgrade,S=P.upgradeLegacyDialog,T=i.product,U=(N=(0,d.Z)(f().mark(function a(){return f().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,O.mutateAsync().then(function(){return y.ZP.success("License key reset successfully")}).catch(function(){return y.ZP.error("Failed to reset license key")});case 2:case"end":return a.stop()}},a)})),function(){return N.apply(this,arguments)}),V="advanced_1"===T&&v("admin"),W="free"!==T&&r.license.update&&j&&(V||"advanced_1"!==T)?(0,g.tZ)(A.Z,{size:"small",variant:"text",startIcon:(0,g.tZ)(z.Icons.AddCircleOutline,{}),loading:Q,onClick:R,children:"Upgrade"}):null,X=r.license.update&&(!t||t&&u)?(0,g.tZ)(A.Z,{size:"small",variant:"text",startIcon:(0,g.tZ)(z.Icons.Reset,{}),loading:O.isLoading,onClick:L,color:"secondary",children:"Reset"}):null,Y=l&&(0,g.BX)(A.Z,{size:"small",variant:"contained",onClick:function(){return l()},children:[" ","Re-Activate"," "]});return(0,g.BX)(g.HY,{children:[(0,g.tZ)(D.Z,{license:i,customerData:j,title:"License",rowActions:{upgrade:W,reset:X},headerAction:k&&k()&&Y}),H,S,K&&(0,g.tZ)(s.dm,{isOpen:K,hide:M,onAccept:U,actionTitle:"Reset your License Key"})]})},I=c(20154),J=c(83206),K=c(94276),L=c(75677),M=c(28354),N=function(a){var b=a.trial,c=(0,G.L)().tokenParsed,d=L.Me,e=function(){var a=(0,M.r)(c,b?"standard":void 0);window.open(a,"_blank")},f=function(){window.open(d,"_blank")};return(0,g.tZ)(I.Z,{children:(0,g.tZ)(J.Z,{children:(0,g.BX)(m.ZP,{container:!0,spacing:1,py:2,display:"flex",justifyContent:"space-between",children:[(0,g.tZ)(m.ZP,{item:!0,md:1,lg:2}),(0,g.tZ)(m.ZP,{item:!0,xs:12,sm:4,md:4,lg:3,textAlign:"center",children:(0,g.tZ)(K.Z,{fullWidth:!0,size:"small",variant:"contained",onClick:e,children:"Buy AnyDesk today"})}),(0,g.tZ)(m.ZP,{item:!0,xs:12,sm:7,md:5,lg:4,textAlign:"center",children:(0,g.tZ)(K.Z,{fullWidth:!0,size:"small",variant:"outlined",onClick:f,children:"Contact us for an individual offer"})}),(0,g.tZ)(m.ZP,{item:!0,md:1,lg:2})]})})})},O=c(8969),P=c(38302),Q=c(2794),R=c(11753),S=c(74439),T=c(80921),U=c(29411),V=c(46951),W=(0,j.default)().publicRuntimeConfig.anydeskGui,X=function(){return"".concat(W,"/license?")},Y=c(39702),Z=c(55535);function $(){var a,b,c=(0,q.E)(),e=(0,o.useQueryClient)(),g=(a=(0,d.Z)(f().mark(function a(b){var d,e,g,h;return f().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return d=b.id,e=b.transactionId,g=b.type,h=b.cardLast4,a.next=3,c.post("/customer/payment/methods/default",{id:d,transactionId:e,type:g,cardLast4:h});case 3:case"end":return a.stop()}},a)})),function(b){return a.apply(this,arguments)});return(0,o.useMutation)(g,{onSuccess:(b=(0,d.Z)(f().mark(function a(b,c){var d;return f().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return d=c.id,a.next=3,e.invalidateQueries(p.X.customers.paymentMethods(d));case 3:case"end":return a.stop()}},a)})),function(a,c){return b.apply(this,arguments)})})}var _=c(13877),aa=c(28409),ab=c(72569),ac=c(24472),ad=c(49602),ae=c(20864),af=c(34647),ag=c(59345),ah=c(52708),ai=function(a){var b,c=a.paymentSession,e=a.safeCharge,h=a.onUpoChange,i=a.setAddCard,j=a.billingAddress,k=a.onClose,l=(0,x.useState)(null),n=l[0],o=l[1],p=(0,x.useState)(new Date(new Date().setFullYear(new Date().getFullYear()+20))),q=p[0],r=c.sessionToken,s=$(),t=(0,ac.cI)({defaultValues:{sessionToken:r,cardHolderName:"",expirationYear:"",expirationMonth:""}}),u=t.handleSubmit,v=t.register,w=t.control,B=t.setValue,C=t.formState.isSubmitting;(0,x.useEffect)(function(){if(n){var a=n.getMonth()+1,b=n.getFullYear().toString().slice(-2),c=a<10?"0".concat(a):a;B("expirationYear",String(b)),B("expirationMonth",String(c))}},[n]);var D=(b=(0,d.Z)(f().mark(function a(b){var c,d,g,l,m;return f().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return c=b.cardHolderName,d=b.cardNumber,g=b.expirationMonth,l=b.expirationYear,m=b.CVV,a.prev=1,a.next=4,e.createPayment({sessionToken:r,paymentOption:{card:{cardNumber:d,cardHolderName:c,expirationMonth:g,expirationYear:l,CVV:m}},billingAddress:j},function(a){if("APPROVED"!==a.result){y.Am.error("Failed to add payment method.");return}h(!0),i(!1),k(),y.Am.success("You have successfully added a new payment method.");try{s.mutate({id:a.userPaymentOptionId,transactionId:a.transactionId,cardLast4:a.ccCardNumber.slice(-4),type:"CARD"})}catch(b){y.Am.error("Failed to set default payment method.")}});case 4:a.next=9;break;case 6:a.prev=6,a.t0=a.catch(1),y.Am.error("Failed to add payment method.");case 9:case"end":return a.stop()}},a,null,[[1,6]])})),function(a){return b.apply(this,arguments)});return(0,g.tZ)("form",{onSubmit:u(D),children:(0,g.BX)(m.ZP,{container:!0,rowSpacing:2.5,columnSpacing:2.5,pt:1,children:[(0,g.tZ)("input",(0,aa.Z)({type:"hidden",id:"sessionToken"},v("sessionToken"))),(0,g.tZ)(m.ZP,{item:!0,xs:12,children:(0,g.tZ)(z.TextField,{as:ad.Z,control:w,rules:{required:!0},required:!0,type:"text",id:"cardHolderName",name:"cardHolderName",label:"Cardholder Name",placeholder:"John Doe"})}),(0,g.tZ)(m.ZP,{item:!0,xs:12,children:(0,g.tZ)(z.TextField,{as:ad.Z,control:w,rules:{required:!0},required:!0,type:"text",id:"cardNumber",name:"cardNumber",label:"Card Number",placeholder:"XXXX XXXX XXXX XXXX"})}),(0,g.tZ)(m.ZP,{item:!0,xs:6,children:(0,g.tZ)(ae._,{dateAdapter:ag.H,adapterLocale:(0,ah.Gr)((0,ah.Kd)()),children:(0,g.tZ)(af.M,{label:"Expires",value:n,onChange:function(a){o(a)},renderInput:function(a){return(0,g.tZ)(ad.Z,(0,ab.Z)((0,aa.Z)({},a),{fullWidth:!0,id:"expires",name:"expires",placeholder:"MM/YY",required:!0}))},minDate:new Date,maxDate:q,openTo:"year",views:["year","month"],inputFormat:"MM/yy"})})}),(0,g.tZ)(m.ZP,{item:!0,xs:6,children:(0,g.tZ)(z.TextField,{as:ad.Z,control:w,rules:{required:!0},required:!0,type:"text",id:"CVV",name:"CVV",label:"CVV"})}),(0,g.tZ)(m.ZP,{item:!0,xs:4,children:(0,g.tZ)(K.Z,{variant:"outlined",onClick:function(){return i(!1)},fullWidth:!0,children:"Return"})}),(0,g.tZ)(m.ZP,{item:!0,xs:8,children:(0,g.tZ)(A.Z,{loading:C,variant:"contained",type:"submit",fullWidth:!0,children:"Save"})})]})})},aj=function(a){var b,c,e,h,i=a.paymentSession,j=a.setIsSepa,k=a.onClose,l=i.sessionToken,n=i.userTokenId,p=(b=(0,q.E)(),e=(c=(0,d.Z)(f().mark(function a(c){var d,e,g;return f().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return d=c.userTokenId,e=c.sessionToken,a.next=3,b.post("customer/payment/methods/".concat(d,"/").concat(e),(0,aa.Z)({},c));case 3:return g=a.sent.data,a.abrupt("return",g);case 5:case"end":return a.stop()}},a)})),function(a){return c.apply(this,arguments)}),(0,o.useMutation)(e)),r=(0,ac.cI)({defaultValues:{sessionToken:l,firstName:"",lastName:"",email:"",iban:""}}),s=r.handleSubmit,t=r.register,u=r.control,v=r.formState.isSubmitting,w=(h=(0,d.Z)(f().mark(function a(b){return f().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return console.log("Submit sepa form",b),a.next=3,p.mutateAsync({paymentMethodName:"apmgw_Sepa",sessionToken:l,userTokenId:n,apmData:{verification_email:b.email,iban:b.iban}}).then(function(a){console.log("Add sepa response",a),j(!1),k()}).catch(function(a){console.log("Add sepa error",a)});case 3:case"end":return a.stop()}},a)})),function(a){return h.apply(this,arguments)});return(0,g.tZ)("form",{onSubmit:s(w),children:(0,g.BX)(m.ZP,{container:!0,rowSpacing:2.5,columnSpacing:2.5,pt:1,children:[(0,g.tZ)("input",(0,aa.Z)({type:"hidden",id:"sessionToken"},t("sessionToken"))),(0,g.tZ)(m.ZP,{item:!0,xs:6,children:(0,g.tZ)(z.TextField,{as:ad.Z,control:u,rules:{required:!0},required:!0,type:"text",id:"firstName",name:"firstName",label:"First Name",placeholder:"First Name"})}),(0,g.tZ)(m.ZP,{item:!0,xs:6,children:(0,g.tZ)(z.TextField,{as:ad.Z,control:u,rules:{required:!0},required:!0,type:"text",id:"lastName",name:"lastName",label:"Last Name",placeholder:"Last Name"})}),(0,g.tZ)(m.ZP,{item:!0,xs:12,children:(0,g.tZ)(z.TextField,{as:ad.Z,control:u,rules:{required:!0},required:!0,type:"email",id:"email",name:"email",label:"Email",placeholder:"Email"})}),(0,g.tZ)(m.ZP,{item:!0,xs:12,children:(0,g.tZ)(z.TextField,{as:ad.Z,control:u,rules:{required:!0},required:!0,type:"text",id:"iban",name:"iban",label:"IBAN",placeholder:"IBAN"})}),(0,g.tZ)(m.ZP,{item:!0,xs:4,children:(0,g.tZ)(K.Z,{variant:"outlined",onClick:function(){return j(!1)},fullWidth:!0,children:"Return"})}),(0,g.tZ)(m.ZP,{item:!0,xs:8,children:(0,g.tZ)(A.Z,{loading:v,variant:"contained",type:"submit",fullWidth:!0,children:"Save"})})]})})},ak=function(a){var b,c,e,h=a.isOpen,i=a.onClose,j=a.paymentSession,k=a.safeCharge,l=a.onUpoChange,m=a.billingData,n=(0,x.useState)("Choose A Payment Method"),o=n[0],p=n[1],q=(0,x.useState)(!1),r=q[0],s=q[1],t=(0,x.useState)(!1),u=t[0],v=t[1],w=(0,x.useState)("#"),A=(w[0],w[1]),B=j.sessionToken,C=j.userTokenId,D=$(),E=(0,Z.Z)(),F="",G="",H="",I="",J="",K="",L="",M="",N="",O=null;m&&m.addresses&&m.addresses.length>0&&(M=(b=m).firstName,N=b.lastName,L=b.email,F=(c=m.addresses[0]).address1,G=c.address2,H=c.zip,I=c.city,J=c.countryCode,K=c.phone),J&&L&&M&&N&&(O={email:L,firstName:M,lastName:N,address:F,address2:G,phone:K,zip:H,city:I,country:J});var P=(e=(0,d.Z)(f().mark(function a(){return f().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,E.mutateAsync().then(function(a){A(a.redirectUrl)}).catch(function(a){var b=a.message;return console.error(b)});case 2:case"end":return a.stop()}},a)})),function(){return e.apply(this,arguments)});(0,x.useEffect)(function(){P()},[]),(0,x.useEffect)(function(){r&&p("Add Credit Card As Payment Method")},[r]),(0,x.useEffect)(function(){u&&p("Add SEPA As Payment Method")},[u]);var Q=function(){try{k.createPayment({sessionToken:B,clientUniqueId:C,paymentOption:{alternativePaymentMethod:{paymentMethod:"apmgw_expresscheckout"},subMethod:{subMethod:"ReferenceTransaction"}},billingAddress:{email:L,firstName:M,lastName:N,address:F,address2:G,phone:K,zip:H,city:I,country:J}},function(a){if("APPROVED"!==a.result){y.Am.error("Failed to add payment method."),console.error(a);return}l(!0),i(),y.Am.success("You have successfully connected your PayPal account");try{D.mutate({id:a.userPaymentOptionId,transactionId:a.transactionId,cardLast4:a.ccCardNumber.slice(-4),type:"PAYPAL"})}catch(b){y.Am.error("Failed to set default payment method.")}})}catch(a){y.Am.error("Failed to connect your PayPal account.")}};return(0,g.BX)(_.Z,{id:"create-payment-method",title:o,open:h,onClose:function(){s(!1),i()},maxWidth:"sm",children:[r&&(0,g.tZ)(ai,{setAddCard:s,billingAddress:O,paymentSession:j,safeCharge:k,onUpoChange:l,onClose:i}),u&&(0,g.tZ)(aj,{paymentSession:j,onClose:i,setIsSepa:v}),!r&&!u&&(0,g.tZ)(g.HY,{children:(0,g.BX)(Y.Z,{children:[(0,g.BX)(U.Z,{hover:!0,onClick:function(){return s(!0)},sx:{height:60},children:[(0,g.tZ)(T.Z,{sx:{pl:2},children:(0,g.tZ)(V.Z,{color:"textPrimary",variant:"subtitle2",display:"flex",alignItems:"center",children:(0,g.tZ)(z.Icons.CreditCard,{size:"xl"})})}),(0,g.BX)(T.Z,{align:"left",sx:{pl:2},colSpan:3,children:[(0,g.tZ)(V.Z,{children:"Add a Credit Card"}),(0,g.tZ)(V.Z,{variant:"body2",children:"We accept Visa, Mastercard, and American Express"})]}),(0,g.tZ)(T.Z,{width:90,align:"right",sx:{pr:2},children:(0,g.tZ)(z.Icons.ArrowRightAlt,{size:"lg"})})]}),(0,g.BX)(U.Z,{hover:!0,onClick:Q,sx:{height:60},children:[(0,g.tZ)(T.Z,{sx:{pl:2},children:(0,g.tZ)(V.Z,{color:"textPrimary",variant:"subtitle2",display:"flex",alignItems:"center",children:(0,g.tZ)(z.Icons.Paypal,{size:"xl"})})}),(0,g.BX)(T.Z,{align:"left",sx:{pl:2},colSpan:3,children:[(0,g.tZ)(V.Z,{children:"Connect to PayPal"}),(0,g.tZ)(V.Z,{variant:"body2",children:"Connect a payment method via your Paypal account"})]}),(0,g.tZ)(T.Z,{width:90,align:"right",sx:{pr:2},children:(0,g.tZ)(z.Icons.ArrowRightAlt,{size:"lg"})})]}),u&&(0,g.BX)(U.Z,{hover:!0,onClick:function(){return v(!0)},sx:{height:60},children:[(0,g.tZ)(T.Z,{sx:{pl:2},children:(0,g.tZ)(V.Z,{color:"textPrimary",variant:"subtitle2",display:"flex",alignItems:"center",children:(0,g.tZ)(z.Icons.Sepa,{size:"xl"})})}),(0,g.BX)(T.Z,{align:"left",sx:{pl:2},colSpan:3,children:[(0,g.tZ)(V.Z,{children:"Add a SEPA direct debit"}),(0,g.tZ)(V.Z,{variant:"body2",children:"Automatically charge you debit card"})]}),(0,g.tZ)(T.Z,{width:90,align:"right",sx:{pr:2},children:(0,g.tZ)(z.Icons.ArrowRightAlt,{size:"lg"})})]})]})})]})},al=(0,j.default)().publicRuntimeConfig,am=function(a){var b=a.editMode,c=a.setEditMode,d=a.openDialog,e=a.children;return(0,g.BX)(g.HY,{children:[b&&(0,g.tZ)(g.HY,{children:e}),b&&(0,g.BX)(g.HY,{children:[(0,g.tZ)(A.Z,{sx:{ml:2},startIcon:(0,g.tZ)(z.Icons.CreditCard,{}),size:"small",variant:"text",onClick:d,children:"Add Payment Method"}),(0,g.tZ)(S.Z,{color:"primary",sx:{ml:2},onClick:function(){return c(!b)},children:(0,g.tZ)(z.Icons.PencilWrite,{})})]}),!b&&(0,g.tZ)(S.Z,{sx:{ml:2,color:"grey.500"},onClick:function(){return c(!b)},children:(0,g.tZ)(z.Icons.PencilWrite,{})})]})},an=(0,P.ZP)(U.Z)(function(a){return a.theme,{"&.Mui-selected":{backgroundColor:"transparent","&:hover":{backgroundColor:"transparent"}}}}),ao=(0,P.ZP)(T.Z)(function(a){var b=a.theme,c=a.selected;return{borderTop:c?"1px solid ".concat(b.palette.primary.main):"none",borderBottom:c?"1px solid ".concat(b.palette.primary.main):"none",backgroundColor:"none","&:first-of-type":{borderLeft:c?"1px solid ".concat(b.palette.primary.main):"none",borderTopLeftRadius:c?10:0,borderBottomLeftRadius:c?10:0},"&:last-of-type":{borderRight:c?"1px solid ".concat(b.palette.primary.main):"none",borderTopRightRadius:c?10:0,borderBottomRightRadius:c?10:0}}}),ap=function(a){var b,c,e,h,i,j,k,l,m,n,r,t,u,v=a.billingData,w=function(a){var b,c=null!==(b=null==a?void 0:a.slice(-4))&& void 0!==b?b:"••••";return"•••• •••• •••• ".concat(c)},B=function(a){var b,c,d,e=null!==(b=null==a?void 0:a.slice(0,2))&& void 0!==b?b:"••",f=null!==(c=null==a?void 0:a.slice(-2))&& void 0!==c?c:"••",g=d=(null==a?void 0:a.length)-4,h="•".repeat(g);return"".concat(e).concat(h).concat(f)},C=function(a){switch(a){case"visa":return(0,g.tZ)(z.Icons.Visa,{});case"master_card":return(0,g.tZ)(z.Icons.Mastercard,{});case"amex":return(0,g.tZ)(z.Icons.Amex,{});default:return(0,g.tZ)(z.Icons.CreditCard,{})}},D=(0,x.useState)(null),F=D[0],G=D[1],H=(0,x.useState)(null),K=H[0],L=H[1],M=(0,x.useState)(null),N=M[0],O=M[1],P=(0,x.useState)(null),S=P[0],W=P[1],Z=(0,x.useState)(),$=Z[0],_=Z[1],aa=(0,x.useState)(!1),ab=aa[0],ac=aa[1],ad=(0,x.useState)(!1),ae=ad[0],af=ad[1],ag=(c=(0,q.E)(),h=(e=(0,d.Z)(f().mark(function a(b){var d,e,g;return f().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return d=b.userTokenId,e=b.sessionTokenId,g=b.userPaymentOptionId,a.next=3,c.delete("/customer/payment/methods/".concat(d,"/").concat(e,"/").concat(g));case 3:case"end":return a.stop()}},a)})),function(a){return e.apply(this,arguments)}),(0,o.useMutation)(h)),ah=al.nuveiEnv,ai=al.nuveiMerchantId,aj=al.nuveiMerchantSiteId,ap=(0,E.Z)(),aq=ap.open,ar=ap.show,as=ap.hide,at=(0,E.Z)(),au=at.open,av=at.show,aw=at.hide,ax=(i=(0,q.E)(),k=(j=(0,d.Z)(f().mark(function a(){var b;return f().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,i.post("/customer/payment/session-token",{successUrl:X(),failureUrl:X(),backUrl:X()});case 2:return b=a.sent.data,a.abrupt("return",b);case 4:case"end":return a.stop()}},a)})),function(){return j.apply(this,arguments)}),(0,o.useQuery)(p.X.customers.sessionToken(),k)),ay=(l=String(null==K?void 0:K.userTokenId),m=String(null==K?void 0:K.sessionToken),n={enabled:!!(null==K?void 0:K.sessionToken)&&!!(null==K?void 0:K.userTokenId)},r=(0,q.E)(),u=(t=(0,d.Z)(f().mark(function a(){var b;return f().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,r.get("/customer/payment/methods/".concat(l,"/").concat(m));case 2:return b=a.sent.data,a.abrupt("return",b);case 4:case"end":return a.stop()}},a)})),function(){return t.apply(this,arguments)}),(0,o.useQuery)(p.X.customers.paymentMethods(null!=m?m:""),u,n)),az=ay.data;(0,x.useEffect)(function(){var a;(null===(a=ax.data)|| void 0===a?void 0:a.sessionToken)&&L(ax.data)},[null===(b=ax.data)|| void 0===b?void 0:b.sessionToken]),(0,x.useEffect)(function(){if(null==K?void 0:K.sessionToken){var a;(a="https://cdn.safecharge.com/safecharge_resources/v1/websdk/safecharge.js",new Promise(function(b,c){var d=Object.assign(document.createElement("script"),{type:"text/javascript",defer:!0,src:a,onerror:function(a){c(a)}});d.onload=function(){b()},document.body.appendChild(d)})).then(function(){G(window.SafeCharge({env:ah,merchantId:ai,merchantSiteId:aj,sessionToken:K.sessionToken}))})}},[null==K?void 0:K.sessionToken]),(0,x.useEffect)(function(){(null==az?void 0:az.defaultPaymentMethod)&&(W(az.defaultPaymentMethod.id),O(az.userPaymentMethods),ac(!1))},[az,ab]);var aA,aB={cc_card:function(a,b){var c=a.upoData;return(0,g.BX)(an,{selected:String(a.userPaymentOptionId)===b,hover:ae,onClick:function(){ae&&String(a.userPaymentOptionId)!==b&&console.log("set default",String(a.userPaymentOptionId))},children:[(0,g.tZ)(ao,{selected:String(a.userPaymentOptionId)===b,sx:{pl:2},height:55,children:(0,g.tZ)(V.Z,{color:"textPrimary",variant:"subtitle2",display:"flex",alignItems:"center",children:C(c.brand)})}),(0,g.tZ)(ao,{selected:String(a.userPaymentOptionId)===b,align:"left",children:(0,g.tZ)(V.Z,{color:"textPrimary",variant:"subtitle2",children:w(c.ccCardNumber)})}),(0,g.tZ)(ao,{selected:String(a.userPaymentOptionId)===b,align:"right",children:(0,g.BX)(Q.Z,{display:"flex",justifyContent:"space-between",width:"90px",children:[(0,g.tZ)(V.Z,{style:{marginRight:"8px"},children:"Expires:"}),(0,g.tZ)(V.Z,{children:"".concat(c.ccExpMonth,"/").concat(c.ccExpYear)})]})}),(0,g.tZ)(ao,{selected:String(a.userPaymentOptionId)===b,width:120,align:"left",children:ae&&String(a.userPaymentOptionId)!==b&&(0,g.tZ)(A.Z,{sx:{ml:2},startIcon:(0,g.tZ)(z.Icons.Delete,{}),size:"small",variant:"text",onClick:function(){_(String(a.userPaymentOptionId)),ar()},children:"Delete"})})]},String(a.userPaymentOptionId))},apmgw_expresscheckout:function(a,b){var c=a.upoData;return"false"===a.depositSuccess?null:(0,g.BX)(an,{hover:ae,children:[(0,g.tZ)(ao,{selected:String(a.userPaymentOptionId)===b,sx:{pl:2},height:55,children:(0,g.tZ)(V.Z,{color:"textPrimary",variant:"subtitle2",display:"flex",alignItems:"center",children:(0,g.tZ)(z.Icons.Paypal,{})})}),(0,g.tZ)(ao,{selected:String(a.userPaymentOptionId)===b,align:"left",colSpan:2,children:(0,g.tZ)(V.Z,{color:"textPrimary",variant:"subtitle2",children:c.email})}),(0,g.tZ)(ao,{selected:String(a.userPaymentOptionId)===b,width:120,align:"left",children:ae&&(0,g.tZ)(A.Z,{sx:{ml:2},startIcon:(0,g.tZ)(z.Icons.Delete,{}),size:"small",variant:"text",onClick:function(){_(String(a.userPaymentOptionId)),ar()},children:"Delete"})})]},String(a.userPaymentOptionId))},apmgw_Sepa:function(a,b){return(0,g.BX)(an,{hover:ae,children:[(0,g.tZ)(ao,{selected:String(a.userPaymentOptionId)===b,sx:{pl:2},height:55,children:(0,g.tZ)(V.Z,{color:"textPrimary",variant:"subtitle2",display:"flex",alignItems:"center",children:(0,g.tZ)(z.Icons.Sepa,{})})}),(0,g.tZ)(ao,{selected:String(a.userPaymentOptionId)===b,align:"left",colSpan:2,children:(0,g.tZ)(V.Z,{color:"textPrimary",variant:"subtitle2",children:B(a.upoName)})}),(0,g.tZ)(ao,{selected:String(a.userPaymentOptionId)===b,width:120,align:"left",children:ae&&(0,g.tZ)(A.Z,{sx:{ml:2},startIcon:(0,g.tZ)(z.Icons.Delete,{}),size:"small",variant:"text",onClick:function(){_(String(a.userPaymentOptionId)),ar()},children:"Delete"})})]},String(a.userPaymentOptionId))}},aC=(aA=(0,d.Z)(f().mark(function a(){return f().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!(!$||!K)){a.next=2;break}return a.abrupt("return");case 2:return a.next=4,ag.mutateAsync({userTokenId:K.userTokenId,sessionTokenId:K.sessionToken,userPaymentOptionId:$}).then(function(){ac(!0),as()}).catch(function(a){y.Am.error(a.message)});case 4:case"end":return a.stop()}},a)})),function(){return aA.apply(this,arguments)});return(0,g.BX)(I.Z,{children:[(0,g.tZ)(R.Z,{title:"Payment Methods",action:K&&(0,g.tZ)(am,{setEditMode:af,openDialog:av,editMode:ae})}),(0,g.tZ)(J.Z,{children:(0,g.BX)(Y.Z,{sx:{borderCollapse:"separate"},children:[null==N?void 0:N.map(function(a){var b=aB[a.paymentMethodName];return b?b(a,S):null}),!(null==N?void 0:N.length)&&(0,g.BX)(U.Z,{children:[(0,g.tZ)(T.Z,{colSpan:3,children:(0,g.tZ)(V.Z,{component:"span",variant:"body2",children:"No payment method has been saved yet"})}),(0,g.tZ)(T.Z,{align:"right",children:K?(0,g.tZ)(s.kw,{title:(0,g.BX)(g.HY,{children:["To add a payment method, click on the ",(0,g.tZ)(z.Icons.PencilWrite,{size:"sm"})," icon above"]}),placement:"top",arrow:!0}):(0,g.tZ)(s.kw,{title:(0,g.tZ)(g.HY,{children:"Something went wrong on our side, you can't create a new payment method now."}),placement:"top",arrow:!0})})]})]})}),aq&&(0,g.tZ)(s.dm,{actionTitle:"Delete payment method",actionBtnText:"Yes, delete",actionContent:"This action is final. Are you sure you want to delete the following payment method?",hide:as,isOpen:aq,onAccept:aC}),au&&F&&K&&(0,g.tZ)(ak,{isOpen:au,onClose:aw,paymentSession:K,safeCharge:F,onUpoChange:ac,billingData:v})]})},aq=c(3830),ar=c(18877),as=c(71588),at=l()(function(){return c.e(756).then(c.bind(c,20756))},{loadableGenerated:{webpack:function(){return[20756]}}}),au=(0,j.default)().publicRuntimeConfig,av=function(){var a=(0,G.L)(),b=a.isCustomer,c=a.api,e=a.license,h=a.isTeam,j=a.requireOwnerOrTeamRoleAnyOf;a.isTeamOwner,a.canCreateOrg,a.canCreateTeam,a.isOrgOwner,a.permitTeamRoleAnyOf;var k,l,t,w,x=(0,r.Z)(),y=x.data,z=x.isLoading,A=x.error,B=(0,n.Z)({enabled:b,initialData:b?void 0:null}),C=B.data,D=B.isLoading,E=(k={enabled:b,initialData:null},l=(0,q.E)(),w=(t=(0,d.Z)(f().mark(function a(){var b;return f().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,l.get("/customer/subscriptions");case 2:return b=a.sent.data,a.abrupt("return",b);case 4:case"end":return a.stop()}},a)})),function(){return t.apply(this,arguments)}),(0,o.useQuery)(p.X.subscription.all(),w,k)),F=E.data;if(!c.license.read)throw new as.ForbiddenError;if(z)return(0,g.tZ)(u.Z,{layout:"detail"});if(A)throw A;if(!y)throw Error("License details page error: no data");var I,J=b&&(!h||j("admin","dpo")),K=y.product,L=0>(0,ah.aQ)(y.expires),M=ar.VQ.includes(K)&&!L,P=(I=(0,d.Z)(f().mark(function a(){var b,c;return f().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return b={Authorization:"Basic ".concat(au.shopAuthHeaderUrl)},c={license_id:y.licenseId,customer_id:null==C?void 0:C.customerId,type:"reactivate_subscription",back_url:au.anydeskGui,error_url:"",create_ip:""},a.abrupt("return",i().post(au.shopLoginUrl,c,{headers:b}).then(function(a){window.open(a.data.redirect_url,"_blank")}).catch(function(){return!1}));case 3:case"end":return a.stop()}},a)})),function(){return I.apply(this,arguments)}),Q=function(){var a,b,c,d=(null==F?void 0:F.items)&&(null==F?void 0:F.items.length)>0?null==F?void 0:F.items.slice(-1)[0]:void 0;if(!(null==C?void 0:C.customerId)||!d)return!1;var f=null!==(c=(null===(a=d.tags)|| void 0===a?void 0:a.includes("forbid-autorenewal"))||(null===(b=d.tags)|| void 0===b?void 0:b.includes("pnf")))&& void 0!==c&&c,g=["TERMINATED","CLOSED"].includes(d.subscriptionStatus||""),h=e.isEndUser;return!f&&!h&&"RESELLER"!==C.category&&g&&e.isExpired};return(0,g.BX)(at,{children:[(0,g.tZ)(s.mr,{title:"License"}),M&&(0,g.tZ)(m.ZP,{container:!0,mb:3,children:(0,g.tZ)(s.yJ,{size:"large",license:y})}),("free"===e.product||e.isTrial)&&(0,g.tZ)(m.ZP,{container:!0,mb:3,children:(0,g.tZ)(m.ZP,{item:!0,xs:12,children:(0,g.tZ)(N,{trial:e.isTrial})})}),(0,g.BX)(m.ZP,{container:!0,mb:3,spacing:3,children:[(0,g.tZ)(m.ZP,{item:!0,xs:6,children:(0,g.tZ)(H,{license:y,customerData:J?C:null,getReactivateConditions:Q,onReactivateLicense:P})}),C&&J&&!D&&(0,g.BX)(g.HY,{children:[C&&(0,g.tZ)(m.ZP,{item:!0,xs:6,children:(0,g.tZ)(v.Z,{billing:C})}),(0,g.tZ)(m.ZP,{item:!0,xs:6,children:(0,g.tZ)(ap,{billingData:C})}),(0,g.tZ)(m.ZP,{item:!0,xs:6,children:(0,g.tZ)(aq.Z,{subscriptions:F,autoDebit:null==C?void 0:C.autoDebit,paymentData:C.defaultPaymentMethod})})]})]}),J&&(0,g.tZ)(m.ZP,{container:!0,children:(0,g.tZ)(m.ZP,{item:!0,xs:12,children:(0,g.tZ)(O.Z,{})})})]})};av.Layout=t.default;var aw=av}},function(a){a.O(0,[3457,119,1418,7848,7390,5734,3738,7457,8535,3833,2772,4472,5507,264,7280,6516,5811,9711,3830,2704,6710,9774,2888,179],function(){var b;return a(a.s=81090)}),_N_E=a.O()}])