"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6710],{86852:function(a,b,c){c.d(b,{Z:function(){return j}});var d=c(41249),e=c(70184),f=c.n(e),g=c(67908),h=c(22056),i=c(75479);function j(a){var b,c=(0,i.E)(),e=(b=(0,d.Z)(f().mark(function a(){var b;return f().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,c.get("/customer");case 2:return b=a.sent.data,a.abrupt("return",b);case 4:case"end":return a.stop()}},a)})),function(){return b.apply(this,arguments)});return(0,g.useQuery)(h.X.billing.details(),e,a)}},25120:function(a,b,c){c.d(b,{v:function(){return p}});var d=c(28409),e=c(15865),f=c(89411),g=c(23727),h=c(2794),i=c(526),j=c(27986),k=c(33270),l=c(73713),m=c(75677),n={next:f.Icons.ArrowRightAlt,previous:f.Icons.ArrowLeftAlt},o=[m.Yu,m.WX,m.UZ,m.OE],p=function(){var a=(0,l.Sh)();if(!(0,l.KE)(a))throw TypeError("TablePagination only allowed in dynamic table");var b=a.page,c=a.paginationSupported,f=a.setPage,m=a.pageCount,p=a.pageSize,q=a.setPageSize,r=a.table;return r.rows.length?(0,e.BX)(h.Z,{display:"flex",flexWrap:"wrap",justifyContent:"right",children:[(0,e.tZ)(i.Z,{sx:{mx:2},children:(0,e.tZ)(j.Z,{defaultValue:p,sx:{px:1},onChange:function(a){return q(Number(a.target.value))},children:o.map(function(a){return(0,e.tZ)("option",{value:a,children:a},a)})})}),(0,e.tZ)(g.Z,{disabled:!c,siblingCount:1,boundaryCount:1,page:b,onChange:function(a,b){return f&&f(b)},count:m,renderItem:function(a){return(0,e.tZ)(e.HY,{children:(0,e.tZ)(k.Z,(0,d.Z)({components:n},a))})}})]}):null};b.Z=p},17443:function(a,b,c){var d=c(28409),e=c(15865),f=c(2794),g=c(46951),h=c(57744),i=function(a){var b=a.disableTypography,c=a.children,i=a.variant,j=void 0===i?"body2":i,k=a.fontWeight,l=void 0===k?400:k,m=a.color,n=void 0===m?"unset":m,o=a.width,p=a.minWidth,q=a.maxWidth,r=a.link,s=a.sx,t=(0,d.Z)({},o&&{width:o},p&&{minWidth:p},q&&{maxWidth:q},s);return(0,e.tZ)(f.Z,{sx:t,children:r?(0,e.tZ)(h.W,{href:r,variant:j,fontWeight:l,color:n,children:c}):void 0!==b&&b?c:(0,e.tZ)(g.Z,{variant:j,fontWeight:l,color:n,children:c})})};b.Z=i},1622:function(a,b,c){c.d(b,{Z:function(){return H}});var d=c(15865),e=c(70079),f=c(94276),g=c(20154),h=c(83206),i=c(11753),j=c(85829),k=c(41249),l=c(28409),m=c(72569),n=c(70184),o=c.n(n),p=c(10969),q=c(69330),r=c(67908),s=c(22056),t=c(75479),u=c(78317),v=c(13130),w=c(59618),x=c(80258),y=c(52708),z=c(936),A=c(5770),B=c(29934),C=c(78953),D=function(a){var b,c,e,f,g,h,i,j,n,D,E,F,G,H,I,J,K=a.details,L=a.isPrivateCustomer,M=a.onSubmit,N=(E=(0,t.E)(),F=(0,r.useQueryClient)(),H=(G=(0,k.Z)(o().mark(function a(b){var c,d;return o().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return c=b.data,d=b.config,a.next=3,E.post("/customer",(0,l.Z)({},c),d);case 3:case"end":return a.stop()}},a)})),function(a){return G.apply(this,arguments)}),(0,r.useMutation)(H,{onSuccess:(0,k.Z)(o().mark(function a(){return o().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,F.invalidateQueries(s.X.billing.details());case 2:case"end":return a.stop()}},a)}))})),O=(0,w.cI)({initialValues:(null==K?void 0:K.addresses.length)===0?(0,m.Z)((0,l.Z)({},K),{addresses:[(0,x.V)()]}):K,validations:(I=L,{firstName:function(a){return(0,w.Gu)((0,w.ID)(!I),(0,w.C1)(a,"First name is required"))},lastName:function(a){return(0,w.Gu)((0,w.ID)(!I),(0,w.C1)(a,"Last name is required"))},billingEmail:function(a){return(0,w.Gu)((0,w.C1)(a,"Email is required"),(0,w.Sz)(C.yk,a,"Email has to be valid"))},companyName:function(a){return(0,w.Gu)((0,w.ID)(I),(0,w.C1)(a,"Company name is required"))},addresses:function(a){var b=a[0],c=b.zip,d=b.city,e=b.phone;return{isValid:!!c&&!!d&&(""===e||C.Uo.test(e)),message:[{zip:c?void 0:"Zip code is required",city:d?void 0:"City is required",phone:e?C.Uo.test(e)?void 0:"Phone number has to be valid":void 0},]}}}),onSubmit:(0,k.Z)(o().mark(function a(){return o().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,N.mutateAsync({data:Q}).then(function(){M(),p.Am.success("Billing information updated")}).catch(function(a){var b=a.message;p.Am.error(b)});case 2:case"end":return a.stop()}},a)}))}),P=O.isSubmitting,Q=O.data,R=O.errors,S=O.handleChange,T=O.setDataProps,U=O.handleSubmit,V=Q.email,W=Q.billingEmail,X=Q.firstName,Y=Q.lastName,Z=Q.addresses,$=Q.companyName,_=Q.locale,aa=Z[0],ab=(J=(0,k.Z)(o().mark(function a(b){return o().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:U(b);case 1:case"end":return a.stop()}},a)})),function(a){return J.apply(this,arguments)}),ac=function(a,b){var c=Z?(0,y.Xh)(Z):[];c[0]||(c[0]=(0,l.Z)({},aa)),c[0][a]=b,T({addresses:c},a)};return void 0===K?(0,d.tZ)(d.HY,{children:"Failed loading billing data"}):(0,d.BX)("form",{onSubmit:ab,autoComplete:"false",children:[(0,d.tZ)(v.C,{label:"Email",value:V,disabled:!0,tooltipProps:{title:B.Ob.EMAIL_NO_CHANGE}}),(0,d.tZ)(v.C,{label:"Billing Email",value:W,onBlur:S("billingEmail"),errorText:null===(b=R.billingEmail)|| void 0===b?void 0:b.message}),L&&(0,d.BX)(d.HY,{children:[(0,d.tZ)(v.C,{value:X,onBlur:S("firstName"),label:"First Name",errorText:null===(c=R.firstName)|| void 0===c?void 0:c.message}),(0,d.tZ)(v.C,{value:Y,onBlur:S("lastName"),label:"Last Name",errorText:null===(e=R.lastName)|| void 0===e?void 0:e.message})]}),(0,d.tZ)(v.C,{label:"Addressee",value:aa.addressee,onBlur:function(a){ac("addressee",a.target.value)}}),!L&&(0,d.tZ)(v.C,{value:$,onBlur:S("companyName"),label:"Company Name",errorText:null===(f=R.companyName)|| void 0===f?void 0:f.message}),(0,d.tZ)(v.C,{label:"Address 1",value:aa.address1,onBlur:function(a){ac("address1",a.target.value)}}),(0,d.tZ)(v.C,{label:"Address 2",value:aa.address2,onBlur:function(a){ac("address2",a.target.value)}}),(0,d.tZ)(v.C,{label:"City",value:aa.city,onBlur:function(a){ac("city",a.target.value)},errorText:null===(h=null===(g=R.addresses)|| void 0===g?void 0:g.message[0])|| void 0===h?void 0:h.city}),(0,d.tZ)(v.C,{label:"Zip code",value:aa.zip,onBlur:function(a){ac("zip",a.target.value)},errorText:null===(j=null===(i=R.addresses)|| void 0===i?void 0:i.message[0])|| void 0===j?void 0:j.zip}),(0,d.tZ)(u.$,{label:"Country",value:aa.countryCode,options:z.J,onChange:function(a){ac("countryCode",a.data.value)}}),(0,d.tZ)(v.C,{label:"Phone",value:aa.phone,onBlur:function(a){ac("phone",a.target.value)},errorText:null===(D=null===(n=R.addresses)|| void 0===n?void 0:n.message[0])|| void 0===D?void 0:D.phone}),(0,d.tZ)(u.$,{label:"Invoice Language",value:_,options:A.b,onChange:S("locale")}),(0,d.tZ)(q.Z,{sx:{mt:1},loading:P,variant:"contained",type:"submit",fullWidth:!0,children:"Submit"})]})},E=c(95003),F=c(82984),G=function(a){var b=a.editing,c=a.onClick;return(0,d.tZ)(f.Z,{variant:"contained",size:"small",onClick:c,children:b?"Cancel":"Edit"})},H=function(a){var b=a.billing,c=(0,e.useState)(!1),f=c[0],k=c[1],l=(0,F.L)(),m=l.isCustomer,n=l.api,o=l.isTeam;if(m&&!b)return(0,d.tZ)(E.Z,{title:"Billing Information",message:"We are unable to fetch your billing information."});var p=(o?n.team.update:n.license.update)&&m?(0,d.tZ)(G,{editing:f,onClick:function(){return k(!f)}}):(0,d.tZ)(d.HY,{}),q=(null==b?void 0:b.category)==="PRIVATE",r=m&&b?f?(0,d.tZ)(D,{details:b,isPrivateCustomer:q,onSubmit:function(){return k(!f)}}):(0,d.tZ)(j.I,{details:b}):(0,d.tZ)(d.HY,{children:"Since you are using a free license, there are no billing information recorded yet. Head over to the shop to purchase an AnyDesk license, and manage your billing information here."});return(0,d.BX)(g.Z,{children:[(0,d.tZ)(i.Z,{action:p,title:"Billing Information"}),(0,d.tZ)(h.Z,{children:r})]})}},8969:function(a,b,c){c.d(b,{Z:function(){return Y}});var d,e,f=c(15865),g=c(20154),h=c(83206),i=c(11753),j=c(95003),k=c(51849),l=c(41249),m=c(70184),n=c.n(m),o=c(70079),p=c(10969),q=c(28409),r=c(67908),s=c(71709),t=c(75479),u=c(75093),v=c(88099),w=function(a){var b,c,d,e,g=a.isOpen,h=a.hide,i=a.status,j=a.recordId,k=a.outstandingAmount,m=a.currency,o=(b=(0,t.E)(),d=(c=(0,l.Z)(n().mark(function a(c){var d,e;return n().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return d=(0,q.Z)({},(0,s.c)("pay-invoice"),c),a.next=3,b.post("/customer/shop/settlement/",(0,q.Z)({},d));case 3:return e=a.sent.data,a.abrupt("return",e);case 5:case"end":return a.stop()}},a)})),function(a){return c.apply(this,arguments)}),(0,r.useMutation)(d)),w=(e=(0,l.Z)(n().mark(function a(){return n().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!("open"!==i)){a.next=2;break}return a.abrupt("return");case 2:return a.next=4,o.mutateAsync({recordId:j}).then(function(a){var b=a.redirectUrl;window.open(b,"_blank")}).catch(function(a){var b=a.message;p.Am.error(b)});case 4:case"end":return a.stop()}},a)})),function(){return e.apply(this,arguments)}),x="open"===i?"You are about to pay the invoice ".concat(j," for the outstanding amount of ").concat(k).concat((0,v.N)(m)):"paidInFull"===i?"This invoice is already paid":"pendingApproval"===i?"This invoice requires approval before handling":"This invoice was either voided or rejected no payment required";return(0,f.tZ)(u.Z,{isOpen:g,hide:h,onAccept:w,actionTitle:"Pay Invoice",actionContent:x,actionBtnText:"open"===i?"Pay":"Close",hideSecondaryBtn:"open"!==i})},x=c(72569),y=c(27219),z=c(87046),A=c.n(z),B=c(58668),C=(d=(0,l.Z)(n().mark(function a(b,c,d){var e;return n().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,b.get("/customer/invoices/".concat(c,"/pdf"),(0,x.Z)((0,q.Z)({},d),{responseType:"blob",timeout:2e4}));case 3:e=a.sent.data,(0,B.a)(e,"anydesk-invoice-".concat(c,".pdf")),a.next=11;break;case 7:a.prev=7,a.t0=a.catch(0),p.Am.error(a.t0.message),console.error("Error",a.t0);case 11:case"end":return a.stop()}},a,null,[[0,7]])})),function(a,b,c){return d.apply(this,arguments)}),D=(e=(0,l.Z)(n().mark(function a(b,c,d){var e,f,g,h;return n().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,e=c.map(function(){var a=(0,l.Z)(n().mark(function a(c){var e;return n().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,b.get("/customer/invoices/".concat(c,"/pdf"),(0,x.Z)((0,q.Z)({},d),{responseType:"blob",timeout:2e4}));case 2:return e=a.sent.data,a.abrupt("return",["anydesk-invoice-".concat(c,".pdf"),e]);case 4:case"end":return a.stop()}},a)}));return function(b){return a.apply(this,arguments)}}()),a.next=4,Promise.all(e);case 4:return f=a.sent,g=new(A()),f.forEach(function(a){var b=(0,y.Z)(a,2),c=b[0],d=b[1];g.file(c,d)}),a.next=9,g.generateAsync({type:"blob"});case 9:h=a.sent,(0,B.a)(h,"anydesk-invoices-".concat(Date.now(),".zip")),a.next=17;break;case 13:a.prev=13,a.t0=a.catch(0),p.Am.error(a.t0.message),console.error("Error",a.t0);case 17:case"end":return a.stop()}},a,null,[[0,13]])})),function(a,b,c){return e.apply(this,arguments)});function E(){var a=(0,t.E)();return{downloadInvoicePdf:function(b,c){return C(a,b,c)},downloadInvoicePdfsInBulk:function(b,c){return D(a,b,c)}}}var F=c(75677),G=c(22056),H={limit:F.UZ};function I(){var a,b=arguments.length>0&& void 0!==arguments[0]?arguments[0]:{},c=(0,q.Z)({},H,b),d=(0,t.E)(),e=(a=(0,l.Z)(n().mark(function a(){var b;return n().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,d.get("/customer/invoices",{params:c});case 2:return b=a.sent.data,a.abrupt("return",b);case 4:case"end":return a.stop()}},a)})),function(){return a.apply(this,arguments)});return(0,r.useQuery)(G.X.invoice.list(c),e)}var J=c(66216),K=c(25120),L=c(13176),M=c(1182),N=c(90820),O=c(89411),P=c(69330),Q=c(17443),R=c(17280),S={open:{text:"Open",color:"blue",icon:"info"},voided:{text:"Error",color:"red",icon:"cancel"},rejected:{text:"Unpaid",color:"red",icon:"error"},paidInFull:{text:"Paid",color:"green",icon:"check"},pendingApproval:{text:"Pending",color:"gray",icon:"error"}},T=function(a){var b=S[a.value],c=b.text,d=b.color,e=b.icon;return(0,f.tZ)(R.om,{label:c,color:d,icon:e})},U=[{Header:"Invoice",accessor:"recordId",Cell:function(a){var b=a.row.original,c=b.recordId,d=b.invoiceId;return(0,f.tZ)(Q.Z,{minWidth:100,children:null!=d?d:c})}},{Header:"Net total",accessor:"subTotal",Cell:function(a){var b=a.row;return(0,f.tZ)(Q.Z,{children:b.original.subTotal+(0,v.N)(b.original.currency)})}},{Header:"GROSS TOTAL",accessor:"total",Cell:function(a){var b=a.row;return(0,f.tZ)(Q.Z,{children:b.original.total+(0,v.N)(b.original.currency)})}},{Header:"OUTSTANDING",accessor:"outstandingAmount",Cell:function(a){var b=a.row;return(0,f.tZ)(Q.Z,{children:b.original.outstandingAmount+(0,v.N)(b.original.currency)})}},{Header:"STATUS",accessor:"status",Cell:function(a){var b=a.row;return(0,f.tZ)(Q.Z,{disableTypography:!0,children:(0,f.tZ)(T,{value:b.original.status})})}},{Header:"",accessor:"download",Cell:function(a){var b,c=a.row,d=(0,o.useState)(!1),e=d[0],g=d[1],h=E().downloadInvoicePdf,i=c.original,j=i.id,k=i.recordId,m=i.status;return(0,f.BX)(Q.Z,{disableTypography:!0,sx:{display:"flex",justifyContent:"flex-start"},children:[(0,f.tZ)(P.Z,{"data-invoice-id":j,color:"secondary",size:"small",loading:e,onClick:(b=(0,l.Z)(n().mark(function a(b){return n().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return b.stopPropagation(),g(!0),a.next=4,h(k);case 4:g(!1);case 5:case"end":return a.stop()}},a)})),function(a){return b.apply(this,arguments)}),children:(0,f.tZ)(O.Icons.DownloadBottom,{})}),("open"===m||"rejected"===m)&&(0,f.tZ)(P.Z,{variant:"outlined",size:"small",startIcon:(0,f.tZ)(O.Icons.Invoice,{}),children:"Pay Now"})]})}},],V=c(5987),W=c(82984),X=function(){var a,b=(0,o.useState)(!1),c=b[0],d=b[1],e=(0,o.useMemo)(function(){return U},[]),g=E().downloadInvoicePdfsInBulk,h=(0,V.Z)(w),i=h.show,j=h.dialog,k=(0,W.L)(),m=k.api,p=k.isTeam,q=k.isTeamOwner,r=(a=(0,l.Z)(n().mark(function a(b){return n().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return d(!0),a.next=3,g(b);case 3:d(!1);case 4:case"end":return a.stop()}},a)})),function(b){return a.apply(this,arguments)}),s=function(a){var b=a.original;if(m.license.update){var c=b.outstandingAmount,d=b.status,e=b.currency,f=b.recordId;i({recordId:f,outstandingAmount:c,status:d,currency:e})}};return(0,f.BX)(L.a,{query:I,columns:e,onRowClick:p?q?s:void 0:s,children:[(0,f.tZ)(M.f,{children:(0,f.tZ)(N.h,{title:"Download invoices",loading:c,action:function(a){return r(a.map(function(a){return a.original.recordId}))},side:"right"})}),(0,f.tZ)(J.i,{}),(0,f.tZ)(K.v,{}),j]})},Y=function(){var a=(0,W.L)(),b=a.isCustomer,c=a.api;if(!b)return(0,f.tZ)(f.HY,{});if(!c.invoice.read)return(0,f.tZ)(j.Z,{title:"Invoices",message:"Forbidden. We're sorry, but you do not have access to see invoices list."});var d=(0,f.BX)(f.HY,{children:["Invoices",(0,f.tZ)(k.Z,{title:"Important : please note that it takes a couple of minutes until your invoice is shown as paid."})]});return(0,f.BX)(g.Z,{children:[(0,f.tZ)(i.Z,{title:d}),(0,f.tZ)(h.Z,{children:(0,f.tZ)(X,{})})]})}}}])