(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3029,8987],{67943:function(a,b,c){(window.__NEXT_P=window.__NEXT_P||[]).push(["/address-books",function(){return c(44597)}])},18987:function(a,b,c){"use strict";c.d(b,{Z:function(){return j}});var d=c(41249),e=c(70184),f=c.n(e),g=c(67908),h=c(22056),i=c(75479);function j(a,b){var c,e=(0,i.E)(),j=(c=(0,d.Z)(f().mark(function b(){var c,d;return f().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return c=void 0!==a?"/admin/licenses/".concat(a):"license",b.next=3,e.get(c);case 3:return d=b.sent.data,b.abrupt("return",d);case 5:case"end":return b.stop()}},b)})),function(){return c.apply(this,arguments)});return(0,g.useQuery)(void 0!==a?h.X.license.detail(a):h.X.license.own(),j,b)}},13130:function(a,b,c){"use strict";c.d(b,{C:function(){return m}});var d=c(28409),e=c(15865),f=c(70079),g=c(89411),h=c(2794),i=c(46951),j=c(49602),k=c(74439),l=c(17280),m=function(a){var b=a.type,c=a.label,m=a.placeholder,n=a.value,o=a.required,p=a.disabled,q=a.multiline,r=a.fullWidth,s=a.outlined,t=a.minRows,u=a.maxRows,v=a.autoComplete,w=a.passwordToggleTime,x=a.disableMaxLength,y=a.noMargins,z=a.onBlur,A=a.errorText,B=a.tooltipProps,C=a.endAdornment,D=(0,f.useState)(n),E=D[0],F=D[1],G=(0,f.useState)(b),H=G[0],I=G[1],J=(0,f.useState)(!1),K=J[0],L=J[1],M=(0,f.useState)(!1),N=M[0],O=M[1],P=(0,f.useState)(-1),Q=P[0],R=P[1];return(0,f.useEffect)(function(){var a=-1;return"password"===b&&"text"===H&&w&&(a=setTimeout(function(){"password"===H?clearTimeout(a):I("password")},w)),function(){clearTimeout(a)}}),(0,e.BX)(h.Z,{display:"flex",alignItems:"center",justifyContent:"space-between",my:y?void 0:1.5,children:[c&&(0,e.BX)(h.Z,{display:"flex",alignItems:"center",children:[(0,e.tZ)(i.Z,{flexBasis:"100%",color:"textSecondary",variant:"body2",className:o?"required":"",children:c}),B&&(0,e.tZ)(l.kw,(0,d.Z)({},B))]}),(0,e.BX)(h.Z,{display:"flex",flexBasis:c?"65%":"100%",children:[(0,e.tZ)(j.Z,{autoComplete:v,disabled:p,multiline:q,fullWidth:r,type:H,style:{flexBasis:"100%"},color:"secondary",variant:s?"outlined":"standard",minRows:t,maxRows:u,placeholder:m,value:N?E:n,onFocus:function(){L(!0)},InputProps:{endAdornment:C,inputProps:x?{maxLength:void 0}:{}},onKeyUp:function(a){"Enter"!==a.key||q?R(setTimeout(function(){z&&z(a,!1,!q)},700)):z&&z(a,!0)},onKeyDown:function(a){clearTimeout(Q),"Enter"!==a.key||q||a.preventDefault()},onChange:function(a){O(!0),F(a.target.value)},onBlur:function(a){z&&z(a,!1,!q),O(!1),L(!1),"password"===b&&I("password")},onAnimationStart:function(a){"mui-auto-fill"===a.animationName&&z&&z(a)},error:Boolean(A),helperText:A}),"password"===b&&K&&E&&(0,e.tZ)(k.Z,{tabIndex:-1,"aria-label":"toggle password visibility",style:{height:"32px",marginLeft:"-40px"},onClick:function(){I("password"===H?"text":"password")},onMouseDown:function(a){return a.preventDefault()},edge:"end",children:"password"===H?(0,e.tZ)(g.Icons.VisibilityOff,{size:"lg"}):(0,e.tZ)(g.Icons.Visibility,{size:"lg"})})]})]})}},98475:function(a,b,c){"use strict";var d=c(15865),e=c(89411),f=c(69330),g=c(2794),h=c(15541),i=function(a){var b=a.label,c=a.variant,i=a.size,j=a.disabled,k=a.loading,l=a.icon,m=void 0===l?(0,d.tZ)(e.Icons.Add,{}):l,n=a.onClick,o=(0,d.tZ)(f.Z,{sx:{ml:1},startIcon:m,onClick:n,variant:void 0===c?"contained":c,disabled:!!j,loading:k,size:void 0===i?"medium":i,children:b});return j?(0,d.tZ)(h.Z,{title:j,placement:"bottom",followCursor:!0,children:(0,d.tZ)(g.Z,{children:o})}):o};b.Z=i},17443:function(a,b,c){"use strict";var d=c(28409),e=c(15865),f=c(2794),g=c(46951),h=c(57744),i=function(a){var b=a.disableTypography,c=a.children,i=a.variant,j=void 0===i?"body2":i,k=a.fontWeight,l=void 0===k?400:k,m=a.color,n=void 0===m?"unset":m,o=a.width,p=a.minWidth,q=a.maxWidth,r=a.link,s=a.sx,t=(0,d.Z)({},o&&{width:o},p&&{minWidth:p},q&&{maxWidth:q},s);return(0,e.tZ)(f.Z,{sx:t,children:r?(0,e.tZ)(h.W,{href:r,variant:j,fontWeight:l,color:n,children:c}):void 0!==b&&b?c:(0,e.tZ)(g.Z,{variant:j,fontWeight:l,color:n,children:c})})};b.Z=i},59618:function(a,b,c){"use strict";c.d(b,{C1:function(){return o},Gu:function(){return u},ID:function(){return t},QH:function(){return r},Sz:function(){return s},Yi:function(){return q},cI:function(){return n},qu:function(){return p}});var d=c(41249),e=c(39175),f=c(28409),g=c(72569),h=c(29240),i=c(27219),j=c(46001),k=c(70184),l=c.n(k),m=c(70079),n=function(a){var b,c=a.validations,k=a.initialValues,n=a.onSubmit,o=a.onError,p=a.trimSpaces,q=void 0===p||p,r=(0,m.useState)(!1),s=r[0],t=r[1],u=(0,m.useState)(k||{}),v=u[0],w=u[1],x=(0,m.useState)({}),y=x[0],z=x[1],A=(0,m.useState)(!1),B=A[0],C=A[1],D=function(a,b,c,d){if("function"==typeof c){var i=c(b,v),k=i.isValid,l=i.message,m=i.reason,n=l;if(d&&"string"!=typeof l&&l&&(n=l.map(function(b,c){var e={},f=y[a],g=f&&f.message?f.message[c]:void 0;return g&&Object.keys(g).forEach(function(a){e[a]=g[a]}),e[d]=b[d],e})),k){y[a];var o=(0,h.Z)(y,[a].map(j.Z));z(o)}else z((0,g.Z)((0,f.Z)({},y),(0,e.Z)({},a,{message:n,reason:m})))}},E=(0,m.useCallback)(function(a,b){return function(d){var h=arguments.length>1&& void 0!==arguments[1]&&arguments[1],i=!(arguments.length>2)|| void 0===arguments[2]||arguments[2],j=d,k=j.data?j.data.value:"checkbox"===j.target.type?j.target.checked:b?b(j.target.value):j.target.value,l=q&&i&&k.trim?k.trim():k;w(function(b){return(0,g.Z)((0,f.Z)({},b),(0,e.Z)({},a,l))}),h&&C(h);var m=c?c[a]:void 0;m&&D(a,l,m)}},[v]),F=(0,m.useCallback)((b=(0,d.Z)(l().mark(function a(b){var d,e,h,j;return l().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(t(!0),null==b||b.preventDefault(),d=0,e=function(a,b,c,h){var j=b[c];if("function"==typeof j){var k=j(h,v),l=k.isValid,m=k.message,n=k.reason,o=k.map,p=k.customErrorCount;return!l&&(a[c]||(d+=p||1),a[c]={message:m,reason:n},o&&Object.entries(o).forEach(function(b){var c=(0,i.Z)(b,2),d=c[0],e=c[1],h=a[d],j=h.message,k=h.reason;a[d]=(0,g.Z)((0,f.Z)({},e),{message:j,reason:k})})),d}return Object.keys(j).forEach(function(b){a[b]={},e(a[b],j,b,h)}),d},!c||(h=0,j={},Object.keys(c).forEach(function(a){var b=v[a];h=e(j,c,a,b)}),!(Object.keys(j).length>0))){a.next=13;break}return t(!1),z(j),o&&o(j,h),a.abrupt("return");case 13:if(z({}),!n){a.next=18;break}return a.next=17,n();case 17:t(!1);case 18:case"end":return a.stop()}},a)})),function(a){return b.apply(this,arguments)}),[v]);(0,m.useEffect)(function(){B&&n&&(F(),C(!1))},[B]);var G=(0,m.useCallback)(function(a,b){b&&Object.entries(a).forEach(function(a){var d=(0,i.Z)(a,2),e=d[0],f=d[1],g=c?c[e]:void 0;g&&D(e,f,g,b)}),w(function(b){return(0,f.Z)({},b,a)})},[]);return{data:v,isSubmitting:s,handleChange:E,handleSubmit:F,setDataProps:G,errors:y}},o=function(a,b){return{isValid:!!a,message:b}},p=function(a,b,c){return{isValid:a===b,message:c}},q=function(a,b,c){return{isValid:b.length<=a,message:c}},r=function(a,b,c){return{isValid:b.length>=a,message:c}},s=function(a,b,c){return{isValid:a.test(b),message:c}},t=function(a){return{isValid:a,message:void 0,reason:"ignore"}},u=function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];for(var d=0;d<b.length;d++){var e=b[d],f=e.isValid,g=e.reason;if("ignore"===g&&f)break;if("ignore"!==g&&!f)return b[d]}return{isValid:!0}}},44597:function(a,b,c){"use strict";c.r(b),c.d(b,{default:function(){return S}});var d=c(27219),e=c(15865),f=c(282),g=c.n(f),h=c(92182),i=c(20154),j=c(83206),k=c(4488),l=c(9549),m=c(41249),n=c(70184),o=c.n(n),p=c(67908),q=c(22056),r=c(75479),s=c(17280),t=c(36516),u=c(13357),v=c(98475),w=c(10969),x=c(69330),y=c(2794),z=c(66082),A=c(13877),B=c(13130),C=c(59618),D=function(a){var b,c,d,f,g,h=a.isOpen,i=a.hide,j=(c=(0,r.E)(),d=(0,p.useQueryClient)(),g=(f=(0,m.Z)(o().mark(function a(b){var d,e,f;return o().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return d=b.input,e=b.requestConfig,a.next=3,c.post("/address-books",d,e);case 3:return f=a.sent.data,a.abrupt("return",f);case 5:case"end":return a.stop()}},a)})),function(a){return f.apply(this,arguments)}),(0,p.useMutation)(g,{onSuccess:(0,m.Z)(o().mark(function a(){return o().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,d.invalidateQueries(q.X.addressBook.all());case 2:case"end":return a.stop()}},a)}))})),k=(0,C.cI)({initialValues:{name:""},validations:{name:function(a){return(0,C.Gu)((0,C.C1)(a,"Address book name field is required"))}},onSubmit:(0,m.Z)(o().mark(function a(){return o().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,j.mutateAsync({input:{name:t.name}}).then(function(){return i()}).then(function(){return w.ZP.success("Address book created!",{id:"addressBookCreationSuccess"})}).catch(function(a){var b=a.message;return w.ZP.error(b)});case 2:case"end":return a.stop()}},a)}))}),l=k.handleChange,n=k.handleSubmit,s=k.errors,t=k.data,u=k.isSubmitting;return(0,e.tZ)(A.Z,{id:"create-address-book",title:"Create new address book",open:h,onClose:i,actions:(0,e.tZ)(x.Z,{type:"submit",variant:"contained",fullWidth:!0,loading:u,onClick:n,disabled:Boolean(s.name),children:"Create address book"}),children:(0,e.tZ)("form",{onSubmit:n,children:(0,e.tZ)(y.Z,{pt:3,children:(0,e.tZ)(z.ZP,{container:!0,spacing:3,children:(0,e.tZ)(z.ZP,{item:!0,xs:12,children:(0,e.tZ)(B.C,{label:"Address book name",value:t.name,onBlur:l("name"),errorText:null===(b=s.name)|| void 0===b?void 0:b.message})})})})})})},E=c(11559),F=c(30449),G=c(74413),H=c(43197),I=c(29411),J=c(46951),K=c(17443),L=function(a){var b=a.data;return(0,e.tZ)(G.Z,{sx:{overflowX:"auto",marginX:"auto"},children:(0,e.BX)(E.Z,{children:[(0,e.tZ)(H.Z,{children:(0,e.tZ)(I.Z,{children:(0,e.tZ)(K.Z,{sx:{p:2},children:"Name"})})}),(0,e.tZ)(F.Z,{children:(0,e.tZ)(I.Z,{hover:!0,children:(0,e.tZ)(K.Z,{sx:{p:2},disableTypography:!0,width:"100%",link:"/address-books/".concat(b.addressBookId),children:(0,e.tZ)(J.Z,{fontWeight:400,variant:"body2",children:b.name})})},b.addressBookId)})]})})},M=c(5987),N=c(20491),O=c(82984),P=g()(function(){return c.e(756).then(c.bind(c,20756))},{loadableGenerated:{webpack:function(){return[20756]}}}),Q=g()(function(){return Promise.all([c.e(8535),c.e(255)]).then(c.bind(c,60255))},{loadableGenerated:{webpack:function(){return[60255]}}}),R=function(){var a,b,c,f,g=(0,h.useRouter)(),n=(0,O.L)(),t=n.api,w=n.license,x=n.permitTeamRoleAnyOf,y=(0,M.Z)(D),z=y.show,A=y.dialog,B=(0,d.Z)((0,N.p)({tab:"personal",page:1}),2),C=B[0],E=B[1],F=null!==(a=C.tab)&& void 0!==a?a:"personal",G=function(a){switch(a){case"perform_1":case"standard_1":case"advanced_1":return x("admin","supporter","dpo")?"Team":"";case"prof_1":case"prof_2":case"power_1":return"License";default:return"Organization"}}(null==w?void 0:w.product),H=(b=(0,r.E)(),f=(c=(0,m.Z)(o().mark(function a(){var c;return o().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,b.get("/address-books/personal");case 2:return c=a.sent.data,a.abrupt("return",c);case 4:case"end":return a.stop()}},a)})),function(){return c.apply(this,arguments)}),(0,p.useQuery)(q.X.addressBook.personal(),f,void 0)),I=H.data,J=H.isLoading,K=H.error,R=t.addressBooks.create&&w.addressBooks.list&&"personal"!==F&&x("admin");if(J)return(0,e.tZ)(u.Z,{});if(K)throw K;if(!I)throw Error("Failed to load personal address book data");if(!(w.addressBooks.list&&t.addressBooks.read))return g.push("/address-books/".concat(I.addressBookId)),(0,e.tZ)(e.HY,{});var S=function(a){return E({tab:a,page:1})};return(0,e.BX)(P,{children:[(0,e.tZ)(s.mr,{title:"Address Books",children:R&&(0,e.tZ)(v.Z,{onClick:z,label:"Create Address Book"})}),(0,e.BX)(l.Z,{sx:{mb:3},variant:"scrollable",scrollButtons:"auto",value:F,onChange:function(a,b){return S(b)},children:[(0,e.tZ)(k.Z,{label:"Personal",value:"personal"},"personal"),(0,e.tZ)(k.Z,{label:G,value:G},"organization")]}),(0,e.tZ)(i.Z,{children:(0,e.tZ)(j.Z,{children:"personal"===F?(0,e.tZ)(L,{data:I}):(0,e.tZ)(Q,{})})}),A]})};R.Layout=t.default;var S=R},46001:function(a,b,c){"use strict";c.d(b,{Z:function(){return e}});var d=c(37724);function e(a){var b=function(a,b){if("object"!==(0,d.Z)(a)||null===a)return a;var c=a[Symbol.toPrimitive];if(void 0!==c){var e=c.call(a,b||"default");if("object"!==(0,d.Z)(e))return e;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===b?String:Number)(a)}(a,"string");return"symbol"===(0,d.Z)(b)?b:String(b)}}},function(a){a.O(0,[3457,119,1418,7848,7390,5734,3738,7457,6232,5507,264,7280,6516,9774,2888,179],function(){var b;return a(a.s=67943)}),_N_E=a.O()}])