"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2406],{75363:function(a,b,c){c.d(b,{Z:function(){return u}});var d=c(92475),e=c(67583),f=c(70079),g=c(19841),h=c(68222),i=c(38302),j=c(31567),k=c(60690),l=c(95136);function m(a){return(0,k.Z)("MuiFormGroup",a)}(0,l.Z)("MuiFormGroup",["root","row","error"]);var n=c(55565),o=c(24903),p=c(35250);let q=["className","row"],r=a=>{let{classes:b,row:c,error:d}=a;return(0,h.Z)({root:["root",c&&"row",d&&"error"]},m,b)},s=(0,i.ZP)("div",{name:"MuiFormGroup",slot:"Root",overridesResolver:(a,b)=>{let{ownerState:c}=a;return[b.root,c.row&&b.row]}})(({ownerState:a})=>(0,e.Z)({display:"flex",flexDirection:"column",flexWrap:"wrap"},a.row&&{flexDirection:"row"})),t=f.forwardRef(function(a,b){let c=(0,j.Z)({props:a,name:"MuiFormGroup"}),{className:f,row:h=!1}=c,i=(0,d.Z)(c,q),k=(0,n.Z)(),l=(0,o.Z)({props:c,muiFormControl:k,states:["error"]}),m=(0,e.Z)({},c,{row:h,error:l.error}),t=r(m);return(0,p.jsx)(s,(0,e.Z)({className:(0,g.Z)(t.root,f),ownerState:m,ref:b},i))});var u=t},56901:function(a,b,c){var d=c(15865),e=c(31953),f=function(a){var b=a.title,c=a.items,f=c.filter(function(a){return!0!==a.isHidden});return f.length>0?(0,d.tZ)(e.ZP,{title:b,elements:f}):(0,d.tZ)(d.HY,{})};b.Z=f},91524:function(a,b,c){var d=c(38494),e=c(28409),f=c(72569),g=c(15865),h=c(71588),i=function(a,b){return function(c){var i=(0,d.Z)({},c);return(0,g.tZ)(h.default,(0,f.Z)((0,e.Z)({},b),{children:(0,g.tZ)(a,(0,e.Z)({},i))}))}};b.Z=i},13850:function(a,b,c){c.d(b,{W:function(){return o}});var d=c(41249),e=c(39175),f=c(70184),g=c.n(f),h=c(15865),i=c(70079),j=c(10969),k=c(69330),l=c(46951),m=c(49602),n=c(49205),o=function(a){var b,c,f=a.hide,o=a.isOpen,p=a.showCreateDialog,q=a.data,r=a.dataKey,s=a.assignLicense,t=a.unassignLicense,u=(0,i.useState)(!1),v=u[0],w=u[1],x=(0,i.useState)(q.licenseId?String(q.licenseId):""),y=x[0],z=x[1],A=(0,i.useState)(void 0),B=A[0],C=A[1],D=(b=(0,d.Z)(g().mark(function a(){var b,c;return g().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(w(!0),a.prev=1,!Number.isNaN(b=parseInt(y,10))){a.next=6;break}return C(Error("License Id '".concat(y,"' is not a valid number."))),a.abrupt("return");case 6:return a.next=8,s.mutateAsync((0,e.Z)({licenseId:b},r,q[r]));case 8:j.Am.success("Successfully assigned license '".concat(y,"' to '").concat(q.target,"'.")),f(),a.next=16;break;case 12:a.prev=12,a.t0=a.catch(1),404003===(c=a.t0.response.data.id)?C(Error("There is no license with the id '".concat(y,"'."))):(console.error(a.t0),C(a.t0));case 16:return a.prev=16,w(!1),a.finish(16);case 19:case"end":return a.stop()}},a,null,[[1,12,16,19]])})),function(){return b.apply(this,arguments)}),E=(c=(0,d.Z)(g().mark(function a(){return g().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return w(!0),a.prev=1,a.next=4,t.mutateAsync((0,e.Z)({},r,q[r]));case 4:j.Am.success("Successfully unassigned '".concat(y,"' from '").concat(q.target,"'.")),f(),a.next=12;break;case 8:a.prev=8,a.t0=a.catch(1),console.error(a.t0),C(a.t0);case 12:return a.prev=12,w(!1),a.finish(12);case 15:case"end":return a.stop()}},a,null,[[1,8,12,15]])})),function(){return c.apply(this,arguments)}),F=function(){f(),p&&p(q)};return(0,h.BX)(n.Vq,{id:"confirmation",title:"Assign license",fullWidth:!0,open:o,onClose:function(){return f()},actions:(0,h.BX)(h.HY,{children:[!!q.licenseId&&(0,h.tZ)(k.Z,{sx:{m:1},variant:"outlined",loading:v,onClick:E,children:"Clear"}),(0,h.tZ)(k.Z,{sx:{m:1},variant:"outlined",onClick:F,children:"Create new license"}),(0,h.tZ)(k.Z,{sx:{m:1},variant:"contained",onClick:D,loading:v,disabled:!y,children:"Assign"})]}),children:[(0,h.BX)(l.Z,{sx:{mb:2},children:["Choose a valid, existing License ID to assign to ",q.target," or choose to create a new license."]}),(0,h.BX)(l.Z,{mb:4,p:2,bgcolor:"lightsalmon",borderRadius:1,fontWeight:500,children:["Changing the license will ",(0,h.tZ)("em",{children:"also"})," change Contract ",(0,h.tZ)("em",{children:"but"})," will not update the Customer! You may end up with an invalid state"]}),(0,h.tZ)(m.Z,{type:"number",autoFocus:!0,fullWidth:!0,label:"License Id",error:!!B,helperText:B?String(B):null,placeholder:"Choose a valid license ID",value:y,onChange:function(a){return z(a.target.value)}})]})}},56173:function(a,b,c){c.d(b,{P:function(){return L}});var d=c(41249),e=c(39175),f=c(28409),g=c(72569),h=c(29240),i=c(27219),j=c(94913),k=c(70184),l=c.n(k),m=c(15865),n=c(69792),o=c(10969),p=c(66967),q=c(69330),r=c(49602),s=c(46951),t=c(75363),u=c(25222),v=c(83065),w=c(2794),x=c(31707),y=c(20864),z=c(34647),A=c(59345),B=c(67908),C=c(22056),D=c(75479),E=c(49205),F=c(18877),G=c(52708),H=p.Rx().nullable().integer("Number must be a valid positive integer.").positive("Number must be a valid positive integer."),I=p.Ry({subscriptionId:p.Z_().required("Subscription ID field is required"),expires:p.Rx().min(Date.now(),"Expiration date must be set in the future").required("Expiration date is required"),product:p.Z_().required("Choice of a product is required").oneOf(F.EY),maxClientCount:H,maxSessionsIn:H,maxConnectionsOut:H,maxSessionLength:H,maxRosterCount:H}),J={subscriptionId:"",expires:new Date(Date.now()+31536e6).getTime(),product:"free",powerUser:!1,maxClientCount:null,maxSessionsIn:null,maxConnectionsOut:null,maxSessionLength:null,maxRosterCount:null},K=function(a){var b,c,k,p,q,E,H=a.hide,K=a.assignLicense,L=a.dataKey,M=a.data,N=a.ignoreProducts,O=(b=(0,B.useQueryClient)(),c=(0,D.E)(),p=(k=(0,d.Z)(l().mark(function a(b){var d;return l().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,c.post("/admin/licenses/",b);case 2:return d=a.sent.data,a.abrupt("return",d);case 4:case"end":return a.stop()}},a)})),function(a){return k.apply(this,arguments)}),q=function(){return b.invalidateQueries(C.X.license.own())},(0,B.useMutation)(p,{onSuccess:q})),P=(0,n.TA)({validateOnBlur:!0,validationSchema:I,initialValues:(0,g.Z)((0,f.Z)({},J),{subscriptionId:"".concat(M.target.replaceAll(/ /g,"-"),"-").concat(Date.now())}),onSubmit:(E=(0,d.Z)(l().mark(function a(b,c){var d,g,i,j,k,m,n,p,q,r,s;return l().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return d=c.resetForm,g=b.product,i=b.expires,j=b.maxClientCount,k=b.maxRosterCount,m=b.maxConnectionsOut,n=b.maxSessionsIn,p=(0,h.Z)(b,["product","expires","maxClientCount","maxRosterCount","maxConnectionsOut","maxSessionsIn"]),q=["free","essentials-1"].includes(g),a.prev=3,a.next=6,O.mutateAsync((0,f.Z)({product:g,expires:i,maxClientCount:q?3:j,maxRosterCount:q?0:k,maxConnectionsOut:q?3:null!=m?m:1,maxSessionsIn:q?3:n},p));case 6:return s=(r=a.sent).licenseId,a.next=10,K.mutateAsync((0,e.Z)({licenseId:s},L,M[L]));case 10:d(),H(),o.Am.success("License '".concat(r.licenseId,"' created and assigned to '").concat(M[L],"'!")),a.next=19;break;case 15:a.prev=15,a.t0=a.catch(3),console.error(a.t0),o.Am.error(a.t0.message);case 19:case"end":return a.stop()}},a,null,[[3,15]])})),function(a,b){return E.apply(this,arguments)})}),Q=(0,j.Z)(new Set(N?F.EY.filter(function(a){return!N.includes(a)}):F.EY)),R=F.VQ.includes(P.values.product),S=(0,m.BX)("form",{onSubmit:P.handleSubmit,children:[(0,m.tZ)(w.Z,{mt:3,children:(0,m.tZ)(r.Z,{autoFocus:!0,fullWidth:!0,select:!0,label:"Product",id:"product",name:"product",value:P.values.product,onChange:P.handleChange,onBlur:P.handleBlur,error:P.touched.product&&!!P.errors.product,helperText:P.touched.product&&P.errors.product,children:(0,j.Z)(Q).sort(function(a,b){var c=F.VQ.includes(a),d=F.VQ.includes(b);return c===d?a>b?1:-1:c?1:-1}).map(function(a){var b=F.VQ.includes(a);return"none"!==a&&(0,m.BX)(x.Z,{value:a,children:[(0,m.tZ)(s.Z,{sx:{flex:1,flexGrow:1},children:a}),b&&(0,m.tZ)(s.Z,{variant:"body2",color:"text.disabled",children:"(legacy)"})]},a)})})}),(0,m.tZ)("br",{}),(0,m.tZ)(s.Z,{children:"Be aware that Subscription IDs must be unique. If you choose a Subscription ID that is actually present by chance, no new license will be created but the existing licene will be used. The suggested Subscription ID contains a current timestamp to circumvent the issue."}),(0,m.tZ)(w.Z,{mt:3,children:(0,m.tZ)(r.Z,{fullWidth:!0,label:"Subscription Id",id:"subscriptionId",name:"subscriptionId",placeholder:"Subscription ID (formerly Contract ID, not required to actually exist)",value:P.values.subscriptionId,onChange:P.handleChange,onBlur:P.handleBlur,error:P.touched.subscriptionId&&!!P.errors.subscriptionId,helperText:P.touched.subscriptionId&&P.errors.subscriptionId})}),(0,m.tZ)(w.Z,{mt:3,children:(0,m.tZ)(y._,{dateAdapter:A.H,adapterLocale:(0,G.Gr)((0,G.Kd)()),children:(0,m.tZ)(z.M,{label:"Expires",value:new Date(P.values.expires),onChange:function(a){P.setFieldValue("expires",a)},renderInput:function(a){return(0,m.tZ)(r.Z,(0,g.Z)((0,f.Z)({},a),{fullWidth:!0,id:"expires",name:"expires",onBlur:P.handleBlur,error:!!P.errors.expires,helperText:P.errors.expires}))}})})}),R&&(0,m.BX)(m.HY,{children:[(0,m.tZ)(w.Z,{mt:3,children:(0,m.tZ)(t.Z,{children:(0,m.tZ)(u.Z,{label:"Power User (legacy)",control:(0,m.tZ)(v.Z,{id:"powerUser",name:"powerUser",checked:P.values.powerUser,onBlur:P.handleBlur,onChange:P.handleChange})})})}),[["maxClientCount","Max number of clients"],["maxSessionsIn","Max number of incoming sessions"],["maxConnectionsOut","Max number of outgoing connections"],["maxSessionLength","Max length of a session in seconds"],["maxRosterCount","Max number of address books"],].map(function(a){var b=(0,i.Z)(a,2),c=b[0],d=b[1];return(0,m.tZ)(w.Z,{mt:3,children:(0,m.tZ)(r.Z,{fullWidth:!0,type:"number",label:d,id:c,name:c,value:P.values[c]||"",onBlur:P.handleBlur,onChange:P.handleChange,error:P.touched[c]&&!!P.errors[c],helperText:P.touched[c]&&P.errors[c]})})})]})]});return{form:S,formik:P}},L=function(a){var b,c=a.isOpen,d=a.hide,f=a.data,g=a.dataKey,h=a.assignLicense,i=a.ignoreProducts,j=K((b={},(0,e.Z)(b,g,f[g]),(0,e.Z)(b,"hide",d),(0,e.Z)(b,"assignLicense",h),(0,e.Z)(b,"dataKey",g),(0,e.Z)(b,"data",f),(0,e.Z)(b,"ignoreProducts",i),b)),k=j.form,l=j.formik;return(0,m.tZ)(E.Vq,{fullWidth:!0,id:"confirmation",title:"Create license for ".concat(f.target),open:c,onClose:function(){l.resetForm(),d()},actions:(0,m.tZ)(q.Z,{variant:"contained",onClick:l.submitForm,loading:l.isSubmitting,disabled:l.isSubmitting||!l.isValid,children:"Create and assign"}),children:k})}}}])